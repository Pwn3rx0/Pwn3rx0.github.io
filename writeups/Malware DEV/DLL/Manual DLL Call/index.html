<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manual DLL Function Calling - pwn3rx0</title>
  <meta name="description" content="A guide to dynamic function resolution in Windows using GetModuleHandle, LoadLibrary, and GetProcAddress for modularity and evasion.">
  <meta name="keywords" content="windows, programming, dll, red-team, win-api, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, shellcode, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/DLL/Manual DLL Call/">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Manual DLL Function Calling">
  <meta property="og:description" content="A guide to dynamic function resolution in Windows using GetModuleHandle, LoadLibrary, and GetProcAddress for modularity and evasion.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/DLL/Manual DLL Call/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Manual DLL Function Calling">
  <meta name="twitter:description" content="A guide to dynamic function resolution in Windows using GetModuleHandle, LoadLibrary, and GetProcAddress for modularity and evasion.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/DLL/">DLL</a>
    
      <span class="separator">/</span>
      <span class="current">Manual DLL Function Calling</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Manual DLL Function Calling</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">windows</span><span class="tag">programming</span><span class="tag">dll</span><span class="tag">red-team</span><span class="tag">win-api</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><h2>Overview</h2>
<p>In Windows programming, you often link DLLs at compile-time. However, sometimes you need to load DLLs dynamically during execution, such as:</p>
<ul>
<li>Loading optional modules or plugins</li>
<li>Performing manual function resolution (e.g., in red team operations)</li>
<li>Avoiding static imports for stealth or evasion</li>
</ul>
<p>The main Windows API functions involved are:</p>
<ul>
<li><strong><code>GetModuleHandleW</code></strong>: Retrieves a handle to a loaded DLL (if already loaded in the process).</li>
<li><strong><code>LoadLibraryW</code></strong>: Loads a DLL into the process address space if not already loaded.</li>
<li><strong><code>GetProcAddress</code></strong>: Retrieves the address of an exported function by name.</li>
</ul>
<hr>
<h2>Code Explanation</h2>
<pre><code class="language-c">#include &lt;windows.h&gt;
#include &lt;stdio.h&gt;

// Define a function pointer type matching the target DLL function signature.
// WINAPI defines the calling convention (__stdcall).
typedef void(WINAPI* TestFunctionPointer)();

int main() {
    // Attempt to get a handle to &quot;test.dll&quot; if it is already loaded.
    HMODULE hDll = GetModuleHandleW(L&quot;test.dll&quot;);

    // If the DLL is not loaded, load it explicitly.
    if (hDll == NULL) {
        hDll = LoadLibraryW(L&quot;test.dll&quot;);
    }

    // Retrieve the address of the exported function named &quot;hacked&quot;.
    PVOID pTest = GetProcAddress(hDll, &quot;hacked&quot;);

    // Cast the retrieved address to our function pointer type.
    TestFunctionPointer Hacked = (TestFunctionPointer)pTest;

    // Call the function dynamically.
    Hacked();

    return 0;
}
</code></pre>
<h2>DLL Code Explanation in <a href="/writeups/Malware%20DEV/DLL/DLL/">DLL</a></h2>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/Malware DEV/DLL/DLL/" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">Introduction to Dynamic Link Libraries (DLLs)</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Execution/Execution/">Shellcode Execution & Injection Strategies</a></li><li><a href="/writeups/Active Directory/Lateral Movement and Pivoting/">Lateral Movement & Pivoting</a></li><li><a href="/writeups/Malware DEV/Encryption/Encryption/">Shellcode Obfuscation & Encryption</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>(function(){function _0x5317f8(_0x29de52){const _0x4f6a8e=_0x29de52||document['querySelector']('.writeup-content')||document,_0x1cbc85=Array['from'](_0x4f6a8e['querySelectorAll']('pre\x20>\x20code'))['filter'](_0x14763a=>!_0x14763a['closest']('.code-block'));_0x1cbc85['forEach'](_0x5685a9=>{const _0x50384f=_0x5685a9['parentElement'];if(!_0x50384f||_0x50384f['dataset']['enhanced']==='true')return;_0x50384f['dataset']['enhanced']='true';let _0x42afa7=Array['from'](_0x5685a9['classList']||[])['find'](_0x4ca885=>_0x4ca885['startsWith']('language-'));if(!_0x42afa7){const _0x2a998b=_0x5685a9['textContent']||'';(/#include\s+<[^>]+>/['test'](_0x2a998b)||/\bint\s+main\s*\(/['test'](_0x2a998b)||/#include\s+<Windows\.h>/i['test'](_0x2a998b))&&(_0x5685a9['classList']['add']('language-c'),_0x42afa7='language-c');}const _0x37de54=(_0x42afa7?_0x42afa7['replace']('language-',''):'text')['toUpperCase'](),_0x9ce47=document['createElement']('div');_0x9ce47['className']='code-block';const _0x34bca1=document['createElement']('div');_0x34bca1['className']='code-header';const _0x9b4c6c=document['createElement']('span');_0x9b4c6c['className']='code-lang',_0x9b4c6c['textContent']=_0x37de54;const _0x2c905b=document['createElement']('button');_0x2c905b['className']='code-copy',_0x2c905b['type']='button',_0x2c905b['textContent']='Copy',_0x2c905b['addEventListener']('click',async()=>{const _0x8aaf8c=_0x5685a9['innerText'],_0x1745d2=()=>{const _0x525785=document['createElement']('textarea');_0x525785['value']=_0x8aaf8c,_0x525785['style']['position']='fixed',_0x525785['style']['opacity']='0',_0x525785['style']['left']='-9999px',document['body']['appendChild'](_0x525785),_0x525785['focus'](),_0x525785['select']();try{document['execCommand']('copy'),_0x2c905b['textContent']='Copied';}catch(_0x1cfc8f){_0x2c905b['textContent']='Failed';}finally{document['body']['removeChild'](_0x525785),setTimeout(()=>_0x2c905b['textContent']='Copy',0x4b0);}};try{navigator['clipboard']&&window['isSecureContext']?(await navigator['clipboard']['writeText'](_0x8aaf8c),_0x2c905b['textContent']='Copied',setTimeout(()=>_0x2c905b['textContent']='Copy',0x4b0)):_0x1745d2();}catch(_0x49501d){_0x1745d2();}}),_0x34bca1['appendChild'](_0x9b4c6c),_0x34bca1['appendChild'](_0x2c905b);const _0x2f9446=document['createElement']('div');_0x2f9446['className']='code-content',_0x50384f['replaceWith'](_0x9ce47),_0x2f9446['appendChild'](_0x50384f),_0x9ce47['appendChild'](_0x34bca1),_0x9ce47['appendChild'](_0x2f9446);if(window['hljs']&&typeof window['hljs']['highlightElement']==='function')window['hljs']['highlightElement'](_0x5685a9);else window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});}function _0x27b2da(_0x46a1d6){const _0xe7f639=_0x46a1d6||document['querySelector']('.writeup-content');if(!_0xe7f639)return;const _0x56f5e2=_0xe7f639['querySelectorAll']('h1,h2,h3,h4,h5,h6');_0x56f5e2['forEach'](_0x333224=>{const _0x2ea446=parseInt(_0x333224['tagName']['substring'](0x1),0xa);let _0x3d066e=_0x333224['nextElementSibling'];while(_0x3d066e){if(/^H[1-6]$/['test'](_0x3d066e['tagName'])){const _0xba0db5=parseInt(_0x3d066e['tagName']['substring'](0x1),0xa);if(_0xba0db5<=_0x2ea446)break;}_0x3d066e['tagName']==='P'&&_0x3d066e['classList']['add']('indent-p'),_0x3d066e=_0x3d066e['nextElementSibling'];}});}function _0xb3bb1b(){window['mermaid']&&mermaid['initialize']({'startOnLoad':!![],'theme':'dark'});_0x5317f8(),_0x27b2da();window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();const _0x59f69f=document['querySelector']('.writeup-content');if(_0x59f69f&&window['MutationObserver']){const _0x1ef280=new MutationObserver(()=>{_0x5317f8(_0x59f69f),_0x27b2da(_0x59f69f),window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});_0x1ef280['observe'](_0x59f69f,{'childList':!![],'subtree':!![]});}}window['addEventListener']('load',_0xb3bb1b);}());</script>
</body>
</html>
