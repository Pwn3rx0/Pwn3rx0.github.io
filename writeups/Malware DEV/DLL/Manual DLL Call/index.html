<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manual DLL Function Calling - pwn3rx0</title>
  <meta name="description" content="A guide to dynamic function resolution in Windows using GetModuleHandle, LoadLibrary, and GetProcAddress for modularity and evasion.">
  <meta name="keywords" content="windows, programming, dll, red-team, win-api, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, shellcode, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/DLL/Manual DLL Call/">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Manual DLL Function Calling">
  <meta property="og:description" content="A guide to dynamic function resolution in Windows using GetModuleHandle, LoadLibrary, and GetProcAddress for modularity and evasion.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/DLL/Manual DLL Call/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Manual DLL Function Calling">
  <meta name="twitter:description" content="A guide to dynamic function resolution in Windows using GetModuleHandle, LoadLibrary, and GetProcAddress for modularity and evasion.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/DLL/">DLL</a>
    
      <span class="separator">/</span>
      <span class="current">Manual DLL Function Calling</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Manual DLL Function Calling</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">windows</span><span class="tag">programming</span><span class="tag">dll</span><span class="tag">red-team</span><span class="tag">win-api</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><h2>Overview</h2>
<p>In Windows programming, you often link DLLs at compile-time. However, sometimes you need to load DLLs dynamically during execution, such as:</p>
<ul>
<li>Loading optional modules or plugins</li>
<li>Performing manual function resolution (e.g., in red team operations)</li>
<li>Avoiding static imports for stealth or evasion</li>
</ul>
<p>The main Windows API functions involved are:</p>
<ul>
<li><strong><code>GetModuleHandleW</code></strong>: Retrieves a handle to a loaded DLL (if already loaded in the process).</li>
<li><strong><code>LoadLibraryW</code></strong>: Loads a DLL into the process address space if not already loaded.</li>
<li><strong><code>GetProcAddress</code></strong>: Retrieves the address of an exported function by name.</li>
</ul>
<hr>
<h2>Code Explanation</h2>
<pre><code class="language-c">#include &lt;windows.h&gt;
#include &lt;stdio.h&gt;

// Define a function pointer type matching the target DLL function signature.
// WINAPI defines the calling convention (__stdcall).
typedef void(WINAPI* TestFunctionPointer)();

int main() {
    // Attempt to get a handle to &quot;test.dll&quot; if it is already loaded.
    HMODULE hDll = GetModuleHandleW(L&quot;test.dll&quot;);

    // If the DLL is not loaded, load it explicitly.
    if (hDll == NULL) {
        hDll = LoadLibraryW(L&quot;test.dll&quot;);
    }

    // Retrieve the address of the exported function named &quot;hacked&quot;.
    PVOID pTest = GetProcAddress(hDll, &quot;hacked&quot;);

    // Cast the retrieved address to our function pointer type.
    TestFunctionPointer Hacked = (TestFunctionPointer)pTest;

    // Call the function dynamically.
    Hacked();

    return 0;
}
</code></pre>
<h2>DLL Code Explanation in <a href="/writeups/Malware%20DEV/DLL/DLL/">DLL</a></h2>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/Malware DEV/DLL/DLL/" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">Introduction to Dynamic Link Libraries (DLLs)</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Execution/Execution/">Shellcode Execution & Injection Strategies</a></li><li><a href="/writeups/Active Directory/Lateral Movement and Pivoting/">Lateral Movement & Pivoting</a></li><li><a href="/writeups/Malware DEV/Encryption/Encryption/">Shellcode Obfuscation & Encryption</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>(function(){function _0x5b0b97(_0x4c548d){const _0x67a6d0=_0x4c548d||document['querySelector']('.writeup-content')||document,_0x3ec232=Array['from'](_0x67a6d0['querySelectorAll']('pre\x20>\x20code'))['filter'](_0x422abc=>!_0x422abc['closest']('.code-block'));_0x3ec232['forEach'](_0x23658b=>{const _0x962f9=_0x23658b['parentElement'];if(!_0x962f9||_0x962f9['dataset']['enhanced']==='true')return;_0x962f9['dataset']['enhanced']='true';let _0x163d16=Array['from'](_0x23658b['classList']||[])['find'](_0x5a2452=>_0x5a2452['startsWith']('language-'));if(!_0x163d16){const _0x1f21dd=_0x23658b['textContent']||'';(/#include\s+<[^>]+>/['test'](_0x1f21dd)||/\bint\s+main\s*\(/['test'](_0x1f21dd)||/#include\s+<Windows\.h>/i['test'](_0x1f21dd))&&(_0x23658b['classList']['add']('language-c'),_0x163d16='language-c');}const _0x3193cc=(_0x163d16?_0x163d16['replace']('language-',''):'text')['toUpperCase'](),_0x374cbf=document['createElement']('div');_0x374cbf['className']='code-block';const _0x134d88=document['createElement']('div');_0x134d88['className']='code-header';const _0x219855=document['createElement']('span');_0x219855['className']='code-lang',_0x219855['textContent']=_0x3193cc;const _0x165d53=document['createElement']('button');_0x165d53['className']='code-copy',_0x165d53['type']='button',_0x165d53['textContent']='Copy',_0x165d53['addEventListener']('click',async()=>{const _0x2548cb=_0x23658b['innerText'],_0x26be26=()=>{const _0x52000b=document['createElement']('textarea');_0x52000b['value']=_0x2548cb,_0x52000b['style']['position']='fixed',_0x52000b['style']['opacity']='0',_0x52000b['style']['left']='-9999px',document['body']['appendChild'](_0x52000b),_0x52000b['focus'](),_0x52000b['select']();try{document['execCommand']('copy'),_0x165d53['textContent']='Copied';}catch(_0x2c8579){_0x165d53['textContent']='Failed';}finally{document['body']['removeChild'](_0x52000b),setTimeout(()=>_0x165d53['textContent']='Copy',0x4b0);}};try{navigator['clipboard']&&window['isSecureContext']?(await navigator['clipboard']['writeText'](_0x2548cb),_0x165d53['textContent']='Copied',setTimeout(()=>_0x165d53['textContent']='Copy',0x4b0)):_0x26be26();}catch(_0x22ff1e){_0x26be26();}}),_0x134d88['appendChild'](_0x219855),_0x134d88['appendChild'](_0x165d53);const _0x2e7727=document['createElement']('div');_0x2e7727['className']='code-content',_0x962f9['replaceWith'](_0x374cbf),_0x2e7727['appendChild'](_0x962f9),_0x374cbf['appendChild'](_0x134d88),_0x374cbf['appendChild'](_0x2e7727);if(window['hljs']&&typeof window['hljs']['highlightElement']==='function')window['hljs']['highlightElement'](_0x23658b);else window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});}function _0x59e40b(_0x458022){const _0x2380db=_0x458022||document['querySelector']('.writeup-content');if(!_0x2380db)return;const _0x7bb0d5=_0x2380db['querySelectorAll']('h1,h2,h3,h4,h5,h6');_0x7bb0d5['forEach'](_0x2c72a8=>{const _0x18cd3d=parseInt(_0x2c72a8['tagName']['substring'](0x1),0xa);let _0x3ca1c5=_0x2c72a8['nextElementSibling'];while(_0x3ca1c5){if(/^H[1-6]$/['test'](_0x3ca1c5['tagName'])){const _0x5f1a54=parseInt(_0x3ca1c5['tagName']['substring'](0x1),0xa);if(_0x5f1a54<=_0x18cd3d)break;}_0x3ca1c5['tagName']==='P'&&_0x3ca1c5['classList']['add']('indent-p'),_0x3ca1c5=_0x3ca1c5['nextElementSibling'];}});}function _0x19a2c1(){window['mermaid']&&mermaid['initialize']({'startOnLoad':!![],'theme':'dark'});_0x5b0b97(),_0x59e40b();window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();const _0x3f0099=document['querySelector']('.writeup-content');if(_0x3f0099&&window['MutationObserver']){const _0x2421be=new MutationObserver(()=>{_0x5b0b97(_0x3f0099),_0x59e40b(_0x3f0099),window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});_0x2421be['observe'](_0x3f0099,{'childList':!![],'subtree':!![]});}}window['addEventListener']('load',_0x19a2c1);}());</script>
</body>
</html>
