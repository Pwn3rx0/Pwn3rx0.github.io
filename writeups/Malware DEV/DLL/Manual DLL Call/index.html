<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manual DLL Function Calling - pwn3rx0</title>
  <meta name="description" content="A guide to dynamic function resolution in Windows using GetModuleHandle, LoadLibrary, and GetProcAddress for modularity and evasion.">
  <meta name="keywords" content="windows, programming, dll, red-team, win-api, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, shellcode, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/DLL/Manual DLL Call/">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Manual DLL Function Calling">
  <meta property="og:description" content="A guide to dynamic function resolution in Windows using GetModuleHandle, LoadLibrary, and GetProcAddress for modularity and evasion.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/DLL/Manual DLL Call/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Manual DLL Function Calling">
  <meta name="twitter:description" content="A guide to dynamic function resolution in Windows using GetModuleHandle, LoadLibrary, and GetProcAddress for modularity and evasion.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/DLL/">DLL</a>
    
      <span class="separator">/</span>
      <span class="current">Manual DLL Function Calling</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Manual DLL Function Calling</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">windows</span><span class="tag">programming</span><span class="tag">dll</span><span class="tag">red-team</span><span class="tag">win-api</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><h2>Overview</h2>
<p>In Windows programming, you often link DLLs at compile-time. However, sometimes you need to load DLLs dynamically during execution, such as:</p>
<ul>
<li>Loading optional modules or plugins</li>
<li>Performing manual function resolution (e.g., in red team operations)</li>
<li>Avoiding static imports for stealth or evasion</li>
</ul>
<p>The main Windows API functions involved are:</p>
<ul>
<li><strong><code>GetModuleHandleW</code></strong>: Retrieves a handle to a loaded DLL (if already loaded in the process).</li>
<li><strong><code>LoadLibraryW</code></strong>: Loads a DLL into the process address space if not already loaded.</li>
<li><strong><code>GetProcAddress</code></strong>: Retrieves the address of an exported function by name.</li>
</ul>
<hr>
<h2>Code Explanation</h2>
<pre><code class="language-c">#include &lt;windows.h&gt;
#include &lt;stdio.h&gt;

// Define a function pointer type matching the target DLL function signature.
// WINAPI defines the calling convention (__stdcall).
typedef void(WINAPI* TestFunctionPointer)();

int main() {
    // Attempt to get a handle to &quot;test.dll&quot; if it is already loaded.
    HMODULE hDll = GetModuleHandleW(L&quot;test.dll&quot;);

    // If the DLL is not loaded, load it explicitly.
    if (hDll == NULL) {
        hDll = LoadLibraryW(L&quot;test.dll&quot;);
    }

    // Retrieve the address of the exported function named &quot;hacked&quot;.
    PVOID pTest = GetProcAddress(hDll, &quot;hacked&quot;);

    // Cast the retrieved address to our function pointer type.
    TestFunctionPointer Hacked = (TestFunctionPointer)pTest;

    // Call the function dynamically.
    Hacked();

    return 0;
}
</code></pre>
<h2>DLL Code Explanation in <a href="/writeups/Malware%20DEV/DLL/DLL/">DLL</a></h2>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/Malware DEV/DLL/DLL/" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">Introduction to Dynamic Link Libraries (DLLs)</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Execution/Execution/">Shellcode Execution & Injection Strategies</a></li><li><a href="/writeups/Active Directory/Lateral Movement and Pivoting/">Lateral Movement & Pivoting</a></li><li><a href="/writeups/Malware DEV/Encryption/Encryption/">Shellcode Obfuscation & Encryption</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>(function(){function _0xf3cf39(_0x46c7f1){const _0x19cf25=_0x46c7f1||document['querySelector']('.writeup-content')||document,_0xe0369b=Array['from'](_0x19cf25['querySelectorAll']('pre\x20>\x20code'))['filter'](_0x49b9e0=>!_0x49b9e0['closest']('.code-block'));_0xe0369b['forEach'](_0x1de239=>{const _0x27e5b=_0x1de239['parentElement'];if(!_0x27e5b||_0x27e5b['dataset']['enhanced']==='true')return;_0x27e5b['dataset']['enhanced']='true';let _0x80752c=Array['from'](_0x1de239['classList']||[])['find'](_0x38f624=>_0x38f624['startsWith']('language-'));if(!_0x80752c){const _0x265d70=_0x1de239['textContent']||'';(/#include\s+<[^>]+>/['test'](_0x265d70)||/\bint\s+main\s*\(/['test'](_0x265d70)||/#include\s+<Windows\.h>/i['test'](_0x265d70))&&(_0x1de239['classList']['add']('language-c'),_0x80752c='language-c');}const _0x123ac0=(_0x80752c?_0x80752c['replace']('language-',''):'text')['toUpperCase'](),_0x1b2be3=document['createElement']('div');_0x1b2be3['className']='code-block';const _0x2bacea=document['createElement']('div');_0x2bacea['className']='code-header';const _0x54c85b=document['createElement']('span');_0x54c85b['className']='code-lang',_0x54c85b['textContent']=_0x123ac0;const _0x29a3a1=document['createElement']('button');_0x29a3a1['className']='code-copy',_0x29a3a1['type']='button',_0x29a3a1['textContent']='Copy',_0x29a3a1['addEventListener']('click',async()=>{const _0x35cdab=_0x1de239['innerText'],_0x19aa3d=()=>{const _0x4a5af5=document['createElement']('textarea');_0x4a5af5['value']=_0x35cdab,_0x4a5af5['style']['position']='fixed',_0x4a5af5['style']['opacity']='0',_0x4a5af5['style']['left']='-9999px',document['body']['appendChild'](_0x4a5af5),_0x4a5af5['focus'](),_0x4a5af5['select']();try{document['execCommand']('copy'),_0x29a3a1['textContent']='Copied';}catch(_0x2dff48){_0x29a3a1['textContent']='Failed';}finally{document['body']['removeChild'](_0x4a5af5),setTimeout(()=>_0x29a3a1['textContent']='Copy',0x4b0);}};try{navigator['clipboard']&&window['isSecureContext']?(await navigator['clipboard']['writeText'](_0x35cdab),_0x29a3a1['textContent']='Copied',setTimeout(()=>_0x29a3a1['textContent']='Copy',0x4b0)):_0x19aa3d();}catch(_0x473110){_0x19aa3d();}}),_0x2bacea['appendChild'](_0x54c85b),_0x2bacea['appendChild'](_0x29a3a1);const _0x17b432=document['createElement']('div');_0x17b432['className']='code-content',_0x27e5b['replaceWith'](_0x1b2be3),_0x17b432['appendChild'](_0x27e5b),_0x1b2be3['appendChild'](_0x2bacea),_0x1b2be3['appendChild'](_0x17b432);if(window['hljs']&&typeof window['hljs']['highlightElement']==='function')window['hljs']['highlightElement'](_0x1de239);else window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});}function _0x328c9a(_0x3c83ac){const _0x28db91=_0x3c83ac||document['querySelector']('.writeup-content');if(!_0x28db91)return;const _0x393af6=_0x28db91['querySelectorAll']('h1,h2,h3,h4,h5,h6');_0x393af6['forEach'](_0x3a19f6=>{const _0x1e7068=parseInt(_0x3a19f6['tagName']['substring'](0x1),0xa);let _0x1681a9=_0x3a19f6['nextElementSibling'];while(_0x1681a9){if(/^H[1-6]$/['test'](_0x1681a9['tagName'])){const _0x26ebb6=parseInt(_0x1681a9['tagName']['substring'](0x1),0xa);if(_0x26ebb6<=_0x1e7068)break;}_0x1681a9['tagName']==='P'&&_0x1681a9['classList']['add']('indent-p'),_0x1681a9=_0x1681a9['nextElementSibling'];}});}function _0x2d4479(){window['mermaid']&&mermaid['initialize']({'startOnLoad':!![],'theme':'dark'});_0xf3cf39(),_0x328c9a();window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();const _0x2dfea4=document['querySelector']('.writeup-content');if(_0x2dfea4&&window['MutationObserver']){const _0x537e36=new MutationObserver(()=>{_0xf3cf39(_0x2dfea4),_0x328c9a(_0x2dfea4),window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});_0x537e36['observe'](_0x2dfea4,{'childList':!![],'subtree':!![]});}}window['addEventListener']('load',_0x2d4479);}());</script>
</body>
</html>
