<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shellcode Obfuscation & Encryption - pwn3rx0</title>
  <meta name="description" content="An overview of why shellcode encryption is vital for bypassing AV/EDR and a comparison of common encryption algorithms.">
  <meta name="keywords" content="malware-development, shellcode, encryption, evasion, red-team, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/Encryption/Encryption.html">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Shellcode Obfuscation & Encryption">
  <meta property="og:description" content="An overview of why shellcode encryption is vital for bypassing AV/EDR and a comparison of common encryption algorithms.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/Encryption/Encryption.html">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Shellcode Obfuscation & Encryption">
  <meta name="twitter:description" content="An overview of why shellcode encryption is vital for bypassing AV/EDR and a comparison of common encryption algorithms.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV.html">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/Encryption.html">Encryption</a>
    
      <span class="separator">/</span>
      <span class="current">Shellcode Obfuscation & Encryption</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Shellcode Obfuscation & Encryption</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">malware-development</span><span class="tag">shellcode</span><span class="tag">encryption</span><span class="tag">evasion</span><span class="tag">red-team</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><p>In the world of malware development, <strong>shellcode</strong> is the &quot;payload&quot;—the actual instructions that execute the malicious intent. However, raw shellcode is incredibly easy for Antivirus (AV) and Endpoint Detection and Response (EDR) systems to spot because it contains predictable patterns and recognizable strings.</p>
<p>To stay invisible, developers use encryption. By encrypting the shellcode, you transform it into <strong>high-entropy data</strong> that looks like random noise. This bypasses static signature scanning, ensuring the payload remains &quot;dead&quot; and unreadable until it is decrypted directly into memory at runtime.</p>
<hr>
<h3>The Evolution of Hiding Techniques</h3>
<p>Different algorithms offer different trade-offs between stealth, complexity, and file size. Here are the common methods used to wrap shellcode:</p>
<ul>
<li><strong>XOR (The Classic):</strong> The simplest form of obfuscation. It’s fast and doesn’t require complex libraries, though simple versions are easily &quot;brute-forced&quot; by modern scanners.</li>
<li><strong>RC4 (The Stealthy Stream):</strong> A favorite for many years because it can be implemented using native Windows APIs (like <code>SystemFunction032</code>), allowing the dev to hide the decryption logic within legitimate system calls.</li>
<li><strong>AES (The Heavyweight):</strong> Provides high security and is very difficult to detect via entropy analysis, though it requires a larger code footprint to implement the full algorithm.</li>
</ul>
<hr>
<h3>Implementation References</h3>
<p>For those looking at how these are structured in code, check out the following implementations:</p>
<ul>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/XOR%201%20Key.html">XOR 1 Key</a></strong> – Basic single-byte XOR rotation.</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/XOR%20KEYS.html">XOR KEYS</a></strong> – Multi-byte or rolling key XOR for increased complexity.</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/RC4%20Native%20API.html">RC4 Native API</a></strong> – Leveraging built-in Windows functions to decrypt data.</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/AES%20tiny.html">AES tiny</a></strong> – A minimal C implementation of the Advanced Encryption Standard.</li>
</ul>
</div>
        <nav class="post-navigation">
          
      <a href="/writeups/Malware DEV/Encryption/AES tiny.html" class="nav-link prev-post">
        <span class="nav-direction">← Previous</span>
        <span class="nav-title">Shellcode Encryption with Tiny AES</span>
      </a>
    
          
      <a href="/writeups/Malware DEV/Encryption/RC4 Native API.html" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">RC4 Stream Cipher (Native API)</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Execution/Execution.html">Shellcode Execution & Injection Strategies</a></li><li><a href="/writeups/Malware DEV/Execution/Local Payload Execution.html">Local Payload Execution</a></li><li><a href="/writeups/Malware DEV/Obfuscation/Obfuscation.html">The Art of Obfuscation</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>
    (function() {
      function enhanceCodeBlocks(scope) {
        const container = scope || document.querySelector('.writeup-content') || document;
        const blocks = Array.from(container.querySelectorAll('pre > code')).filter(c => !c.closest('.code-block'));
        blocks.forEach(code => {
          const pre = code.parentElement;
          if (!pre || pre.dataset.enhanced === 'true') return;
          pre.dataset.enhanced = 'true';
          let langClass = Array.from(code.classList || []).find(c => c.startsWith('language-'));
          if (!langClass) {
            const t = code.textContent || '';
            if (/#include\s+<[^>]+>/.test(t) || /\bint\s+main\s*\(/.test(t) || /#include\s+<Windows\.h>/i.test(t)) {
              code.classList.add('language-c');
              langClass = 'language-c';
            }
          }
          const lang = (langClass ? langClass.replace('language-', '') : 'text').toUpperCase();
          const wrapper = document.createElement('div');
          wrapper.className = 'code-block';
          const header = document.createElement('div');
          header.className = 'code-header';
          const langEl = document.createElement('span');
          langEl.className = 'code-lang';
          langEl.textContent = lang;
          const btn = document.createElement('button');
          btn.className = 'code-copy';
          btn.type = 'button';
          btn.textContent = 'Copy';
          btn.addEventListener('click', async () => {
            const text = code.innerText;
            const fallbackCopy = () => {
              const ta = document.createElement('textarea');
              ta.value = text;
              ta.style.position = 'fixed';
              ta.style.opacity = '0';
              ta.style.left = '-9999px';
              document.body.appendChild(ta);
              ta.focus();
              ta.select();
              try {
                document.execCommand('copy');
                btn.textContent = 'Copied';
              } catch (_) {
                btn.textContent = 'Failed';
              } finally {
                document.body.removeChild(ta);
                setTimeout(() => (btn.textContent = 'Copy'), 1200);
              }
            };
            try {
              if (navigator.clipboard && window.isSecureContext) {
                await navigator.clipboard.writeText(text);
                btn.textContent = 'Copied';
                setTimeout(() => (btn.textContent = 'Copy'), 1200);
              } else {
                fallbackCopy();
              }
            } catch (_) {
              fallbackCopy();
            }
          });
          header.appendChild(langEl);
          header.appendChild(btn);
          const holder = document.createElement('div');
          holder.className = 'code-content';
          pre.replaceWith(wrapper);
          holder.appendChild(pre);
          wrapper.appendChild(header);
          wrapper.appendChild(holder);
          if (window.hljs && typeof window.hljs.highlightElement === 'function') {
            window.hljs.highlightElement(code);
          } else if (window.hljs && typeof window.hljs.highlightAll === 'function') {
            window.hljs.highlightAll();
          }
        });
      }
      function indentAfterHeadings(scope) {
        const container = scope || document.querySelector('.writeup-content');
        if (!container) return;
        const headings = container.querySelectorAll('h1,h2,h3,h4,h5,h6');
        headings.forEach(h => {
          const level = parseInt(h.tagName.substring(1), 10);
          let el = h.nextElementSibling;
          while (el) {
            if (/^H[1-6]$/.test(el.tagName)) {
              const nextLevel = parseInt(el.tagName.substring(1), 10);
              if (nextLevel <= level) break;
            }
            if (el.tagName === 'P') {
              el.classList.add('indent-p');
            }
            el = el.nextElementSibling;
          }
        });
      }
      function initEnhancements() {
        if (window.mermaid) {
          mermaid.initialize({ startOnLoad: true, theme: 'dark' });
        }
        enhanceCodeBlocks();
        indentAfterHeadings();
        if (window.hljs && typeof window.hljs.highlightAll === 'function') {
          window.hljs.highlightAll();
        }
        const target = document.querySelector('.writeup-content');
        if (target && window.MutationObserver) {
          const mo = new MutationObserver(() => {
            enhanceCodeBlocks(target);
            indentAfterHeadings(target);
            if (window.hljs && typeof window.hljs.highlightAll === 'function') {
              window.hljs.highlightAll();
            }
          });
          mo.observe(target, { childList: true, subtree: true });
        }
      }
      window.addEventListener('load', initEnhancements);
    })();
  </script>
</body>
</html>
