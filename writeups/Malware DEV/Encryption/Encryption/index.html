<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shellcode Obfuscation & Encryption - pwn3rx0</title>
  <meta name="description" content="An overview of why shellcode encryption is vital for bypassing AV/EDR and a comparison of common encryption algorithms.">
  <meta name="keywords" content="malware-development, shellcode, encryption, evasion, red-team, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/Encryption/Encryption/">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Shellcode Obfuscation & Encryption">
  <meta property="og:description" content="An overview of why shellcode encryption is vital for bypassing AV/EDR and a comparison of common encryption algorithms.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/Encryption/Encryption/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Shellcode Obfuscation & Encryption">
  <meta name="twitter:description" content="An overview of why shellcode encryption is vital for bypassing AV/EDR and a comparison of common encryption algorithms.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/Encryption/">Encryption</a>
    
      <span class="separator">/</span>
      <span class="current">Shellcode Obfuscation & Encryption</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Shellcode Obfuscation & Encryption</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">malware-development</span><span class="tag">shellcode</span><span class="tag">encryption</span><span class="tag">evasion</span><span class="tag">red-team</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><p>In the world of malware development, <strong>shellcode</strong> is the &quot;payload&quot;—the actual instructions that execute the malicious intent. However, raw shellcode is incredibly easy for Antivirus (AV) and Endpoint Detection and Response (EDR) systems to spot because it contains predictable patterns and recognizable strings.</p>
<p>To stay invisible, developers use encryption. By encrypting the shellcode, you transform it into <strong>high-entropy data</strong> that looks like random noise. This bypasses static signature scanning, ensuring the payload remains &quot;dead&quot; and unreadable until it is decrypted directly into memory at runtime.</p>
<hr>
<h3>The Evolution of Hiding Techniques</h3>
<p>Different algorithms offer different trade-offs between stealth, complexity, and file size. Here are the common methods used to wrap shellcode:</p>
<ul>
<li><strong>XOR (The Classic):</strong> The simplest form of obfuscation. It’s fast and doesn’t require complex libraries, though simple versions are easily &quot;brute-forced&quot; by modern scanners.</li>
<li><strong>RC4 (The Stealthy Stream):</strong> A favorite for many years because it can be implemented using native Windows APIs (like <code>SystemFunction032</code>), allowing the dev to hide the decryption logic within legitimate system calls.</li>
<li><strong>AES (The Heavyweight):</strong> Provides high security and is very difficult to detect via entropy analysis, though it requires a larger code footprint to implement the full algorithm.</li>
</ul>
<hr>
<h3>Implementation References</h3>
<p>For those looking at how these are structured in code, check out the following implementations:</p>
<ul>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/XOR%201%20Key/">XOR 1 Key</a></strong> – Basic single-byte XOR rotation.</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/XOR%20KEYS/">XOR KEYS</a></strong> – Multi-byte or rolling key XOR for increased complexity.</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/RC4%20Native%20API/">RC4 Native API</a></strong> – Leveraging built-in Windows functions to decrypt data.</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/AES%20tiny/">AES tiny</a></strong> – A minimal C implementation of the Advanced Encryption Standard.</li>
</ul>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/Malware DEV/Encryption/AES tiny/" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">Shellcode Encryption with Tiny AES</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Execution/Execution/">Shellcode Execution & Injection Strategies</a></li><li><a href="/writeups/Malware DEV/Execution/Local Payload Execution/">Local Payload Execution</a></li><li><a href="/writeups/Malware DEV/Obfuscation/Obfuscation/">The Art of Obfuscation</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>(function(){function _0x2da795(_0x108c1d){const _0x116088=_0x108c1d||document['querySelector']('.writeup-content')||document,_0x4e40a6=Array['from'](_0x116088['querySelectorAll']('pre\x20>\x20code'))['filter'](_0x312610=>!_0x312610['closest']('.code-block'));_0x4e40a6['forEach'](_0x513c4e=>{const _0x43e9df=_0x513c4e['parentElement'];if(!_0x43e9df||_0x43e9df['dataset']['enhanced']==='true')return;_0x43e9df['dataset']['enhanced']='true';let _0x32bbb9=Array['from'](_0x513c4e['classList']||[])['find'](_0x5e6dc1=>_0x5e6dc1['startsWith']('language-'));if(!_0x32bbb9){const _0x2194f8=_0x513c4e['textContent']||'';(/#include\s+<[^>]+>/['test'](_0x2194f8)||/\bint\s+main\s*\(/['test'](_0x2194f8)||/#include\s+<Windows\.h>/i['test'](_0x2194f8))&&(_0x513c4e['classList']['add']('language-c'),_0x32bbb9='language-c');}const _0x200c7f=(_0x32bbb9?_0x32bbb9['replace']('language-',''):'text')['toUpperCase'](),_0x25aef5=document['createElement']('div');_0x25aef5['className']='code-block';const _0x1cd0c8=document['createElement']('div');_0x1cd0c8['className']='code-header';const _0xf308fb=document['createElement']('span');_0xf308fb['className']='code-lang',_0xf308fb['textContent']=_0x200c7f;const _0x15a3a1=document['createElement']('button');_0x15a3a1['className']='code-copy',_0x15a3a1['type']='button',_0x15a3a1['textContent']='Copy',_0x15a3a1['addEventListener']('click',async()=>{const _0x5228fa=_0x513c4e['innerText'],_0x264d07=()=>{const _0x34dead=document['createElement']('textarea');_0x34dead['value']=_0x5228fa,_0x34dead['style']['position']='fixed',_0x34dead['style']['opacity']='0',_0x34dead['style']['left']='-9999px',document['body']['appendChild'](_0x34dead),_0x34dead['focus'](),_0x34dead['select']();try{document['execCommand']('copy'),_0x15a3a1['textContent']='Copied';}catch(_0x441ed7){_0x15a3a1['textContent']='Failed';}finally{document['body']['removeChild'](_0x34dead),setTimeout(()=>_0x15a3a1['textContent']='Copy',0x4b0);}};try{navigator['clipboard']&&window['isSecureContext']?(await navigator['clipboard']['writeText'](_0x5228fa),_0x15a3a1['textContent']='Copied',setTimeout(()=>_0x15a3a1['textContent']='Copy',0x4b0)):_0x264d07();}catch(_0x47ac44){_0x264d07();}}),_0x1cd0c8['appendChild'](_0xf308fb),_0x1cd0c8['appendChild'](_0x15a3a1);const _0x305e73=document['createElement']('div');_0x305e73['className']='code-content',_0x43e9df['replaceWith'](_0x25aef5),_0x305e73['appendChild'](_0x43e9df),_0x25aef5['appendChild'](_0x1cd0c8),_0x25aef5['appendChild'](_0x305e73);if(window['hljs']&&typeof window['hljs']['highlightElement']==='function')window['hljs']['highlightElement'](_0x513c4e);else window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});}function _0x5adb25(_0x4fe67a){const _0x4d0cd4=_0x4fe67a||document['querySelector']('.writeup-content');if(!_0x4d0cd4)return;const _0x10ad23=_0x4d0cd4['querySelectorAll']('h1,h2,h3,h4,h5,h6');_0x10ad23['forEach'](_0x4e32d5=>{const _0x96e671=parseInt(_0x4e32d5['tagName']['substring'](0x1),0xa);let _0x122f01=_0x4e32d5['nextElementSibling'];while(_0x122f01){if(/^H[1-6]$/['test'](_0x122f01['tagName'])){const _0x127592=parseInt(_0x122f01['tagName']['substring'](0x1),0xa);if(_0x127592<=_0x96e671)break;}_0x122f01['tagName']==='P'&&_0x122f01['classList']['add']('indent-p'),_0x122f01=_0x122f01['nextElementSibling'];}});}function _0x3d3543(){window['mermaid']&&mermaid['initialize']({'startOnLoad':!![],'theme':'dark'});_0x2da795(),_0x5adb25();window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();const _0x280547=document['querySelector']('.writeup-content');if(_0x280547&&window['MutationObserver']){const _0x2e8e70=new MutationObserver(()=>{_0x2da795(_0x280547),_0x5adb25(_0x280547),window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});_0x2e8e70['observe'](_0x280547,{'childList':!![],'subtree':!![]});}}window['addEventListener']('load',_0x3d3543);}());</script>
</body>
</html>
