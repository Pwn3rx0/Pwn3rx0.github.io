<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shellcode Obfuscation & Encryption - pwn3rx0</title>
  <meta name="description" content="An overview of why shellcode encryption is vital for bypassing AV/EDR and a comparison of common encryption algorithms.">
  <meta name="keywords" content="malware-development, shellcode, encryption, evasion, red-team, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/Encryption/Encryption/">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Shellcode Obfuscation & Encryption">
  <meta property="og:description" content="An overview of why shellcode encryption is vital for bypassing AV/EDR and a comparison of common encryption algorithms.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/Encryption/Encryption/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Shellcode Obfuscation & Encryption">
  <meta name="twitter:description" content="An overview of why shellcode encryption is vital for bypassing AV/EDR and a comparison of common encryption algorithms.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/Encryption/">Encryption</a>
    
      <span class="separator">/</span>
      <span class="current">Shellcode Obfuscation & Encryption</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Shellcode Obfuscation & Encryption</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">malware-development</span><span class="tag">shellcode</span><span class="tag">encryption</span><span class="tag">evasion</span><span class="tag">red-team</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><p>In the world of malware development, <strong>shellcode</strong> is the &quot;payload&quot;—the actual instructions that execute the malicious intent. However, raw shellcode is incredibly easy for Antivirus (AV) and Endpoint Detection and Response (EDR) systems to spot because it contains predictable patterns and recognizable strings.</p>
<p>To stay invisible, developers use encryption. By encrypting the shellcode, you transform it into <strong>high-entropy data</strong> that looks like random noise. This bypasses static signature scanning, ensuring the payload remains &quot;dead&quot; and unreadable until it is decrypted directly into memory at runtime.</p>
<hr>
<h3>The Evolution of Hiding Techniques</h3>
<p>Different algorithms offer different trade-offs between stealth, complexity, and file size. Here are the common methods used to wrap shellcode:</p>
<ul>
<li><strong>XOR (The Classic):</strong> The simplest form of obfuscation. It’s fast and doesn’t require complex libraries, though simple versions are easily &quot;brute-forced&quot; by modern scanners.</li>
<li><strong>RC4 (The Stealthy Stream):</strong> A favorite for many years because it can be implemented using native Windows APIs (like <code>SystemFunction032</code>), allowing the dev to hide the decryption logic within legitimate system calls.</li>
<li><strong>AES (The Heavyweight):</strong> Provides high security and is very difficult to detect via entropy analysis, though it requires a larger code footprint to implement the full algorithm.</li>
</ul>
<hr>
<h3>Implementation References</h3>
<p>For those looking at how these are structured in code, check out the following implementations:</p>
<ul>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/XOR%201%20Key/">XOR 1 Key</a></strong> – Basic single-byte XOR rotation.</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/XOR%20KEYS/">XOR KEYS</a></strong> – Multi-byte or rolling key XOR for increased complexity.</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/RC4%20Native%20API/">RC4 Native API</a></strong> – Leveraging built-in Windows functions to decrypt data.</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/AES%20tiny/">AES tiny</a></strong> – A minimal C implementation of the Advanced Encryption Standard.</li>
</ul>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/Malware DEV/Encryption/AES tiny/" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">Shellcode Encryption with Tiny AES</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Execution/Execution/">Shellcode Execution & Injection Strategies</a></li><li><a href="/writeups/Malware DEV/Execution/Local Payload Execution/">Local Payload Execution</a></li><li><a href="/writeups/Malware DEV/Obfuscation/Obfuscation/">The Art of Obfuscation</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>(function(){function _0xd899c4(_0x148c87){const _0x22ff41=_0x148c87||document['querySelector']('.writeup-content')||document,_0x345ef8=Array['from'](_0x22ff41['querySelectorAll']('pre\x20>\x20code'))['filter'](_0x4d2eb8=>!_0x4d2eb8['closest']('.code-block'));_0x345ef8['forEach'](_0x5a151c=>{const _0x3a27ec=_0x5a151c['parentElement'];if(!_0x3a27ec||_0x3a27ec['dataset']['enhanced']==='true')return;_0x3a27ec['dataset']['enhanced']='true';let _0x395535=Array['from'](_0x5a151c['classList']||[])['find'](_0x565a64=>_0x565a64['startsWith']('language-'));if(!_0x395535){const _0x2fb3a2=_0x5a151c['textContent']||'';(/#include\s+<[^>]+>/['test'](_0x2fb3a2)||/\bint\s+main\s*\(/['test'](_0x2fb3a2)||/#include\s+<Windows\.h>/i['test'](_0x2fb3a2))&&(_0x5a151c['classList']['add']('language-c'),_0x395535='language-c');}const _0x136ec4=(_0x395535?_0x395535['replace']('language-',''):'text')['toUpperCase'](),_0x13174c=document['createElement']('div');_0x13174c['className']='code-block';const _0x27c40d=document['createElement']('div');_0x27c40d['className']='code-header';const _0x1aaa19=document['createElement']('span');_0x1aaa19['className']='code-lang',_0x1aaa19['textContent']=_0x136ec4;const _0x4a738d=document['createElement']('button');_0x4a738d['className']='code-copy',_0x4a738d['type']='button',_0x4a738d['textContent']='Copy',_0x4a738d['addEventListener']('click',async()=>{const _0x2b8ed9=_0x5a151c['innerText'],_0x14101a=()=>{const _0x8d4163=document['createElement']('textarea');_0x8d4163['value']=_0x2b8ed9,_0x8d4163['style']['position']='fixed',_0x8d4163['style']['opacity']='0',_0x8d4163['style']['left']='-9999px',document['body']['appendChild'](_0x8d4163),_0x8d4163['focus'](),_0x8d4163['select']();try{document['execCommand']('copy'),_0x4a738d['textContent']='Copied';}catch(_0x415089){_0x4a738d['textContent']='Failed';}finally{document['body']['removeChild'](_0x8d4163),setTimeout(()=>_0x4a738d['textContent']='Copy',0x4b0);}};try{navigator['clipboard']&&window['isSecureContext']?(await navigator['clipboard']['writeText'](_0x2b8ed9),_0x4a738d['textContent']='Copied',setTimeout(()=>_0x4a738d['textContent']='Copy',0x4b0)):_0x14101a();}catch(_0x254e83){_0x14101a();}}),_0x27c40d['appendChild'](_0x1aaa19),_0x27c40d['appendChild'](_0x4a738d);const _0x4943fd=document['createElement']('div');_0x4943fd['className']='code-content',_0x3a27ec['replaceWith'](_0x13174c),_0x4943fd['appendChild'](_0x3a27ec),_0x13174c['appendChild'](_0x27c40d),_0x13174c['appendChild'](_0x4943fd);if(window['hljs']&&typeof window['hljs']['highlightElement']==='function')window['hljs']['highlightElement'](_0x5a151c);else window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});}function _0x25694e(_0x9957bd){const _0x29445b=_0x9957bd||document['querySelector']('.writeup-content');if(!_0x29445b)return;const _0x2b8532=_0x29445b['querySelectorAll']('h1,h2,h3,h4,h5,h6');_0x2b8532['forEach'](_0x31693d=>{const _0x5428bd=parseInt(_0x31693d['tagName']['substring'](0x1),0xa);let _0x4e0624=_0x31693d['nextElementSibling'];while(_0x4e0624){if(/^H[1-6]$/['test'](_0x4e0624['tagName'])){const _0x59688d=parseInt(_0x4e0624['tagName']['substring'](0x1),0xa);if(_0x59688d<=_0x5428bd)break;}_0x4e0624['tagName']==='P'&&_0x4e0624['classList']['add']('indent-p'),_0x4e0624=_0x4e0624['nextElementSibling'];}});}function _0x12080b(){window['mermaid']&&mermaid['initialize']({'startOnLoad':!![],'theme':'dark'});_0xd899c4(),_0x25694e();window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();const _0x105ef7=document['querySelector']('.writeup-content');if(_0x105ef7&&window['MutationObserver']){const _0x230992=new MutationObserver(()=>{_0xd899c4(_0x105ef7),_0x25694e(_0x105ef7),window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});_0x230992['observe'](_0x105ef7,{'childList':!![],'subtree':!![]});}}window['addEventListener']('load',_0x12080b);}());</script>
</body>
</html>
