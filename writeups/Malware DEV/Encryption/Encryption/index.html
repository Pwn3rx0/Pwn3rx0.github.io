<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shellcode Obfuscation & Encryption - pwn3rx0</title>
  <meta name="description" content="An overview of why shellcode encryption is vital for bypassing AV/EDR and a comparison of common encryption algorithms.">
  <meta name="keywords" content="malware-development, shellcode, encryption, evasion, red-team, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/Encryption/Encryption/">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Shellcode Obfuscation & Encryption">
  <meta property="og:description" content="An overview of why shellcode encryption is vital for bypassing AV/EDR and a comparison of common encryption algorithms.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/Encryption/Encryption/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Shellcode Obfuscation & Encryption">
  <meta name="twitter:description" content="An overview of why shellcode encryption is vital for bypassing AV/EDR and a comparison of common encryption algorithms.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/Encryption/">Encryption</a>
    
      <span class="separator">/</span>
      <span class="current">Shellcode Obfuscation & Encryption</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Shellcode Obfuscation & Encryption</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">malware-development</span><span class="tag">shellcode</span><span class="tag">encryption</span><span class="tag">evasion</span><span class="tag">red-team</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><p>In the world of malware development, <strong>shellcode</strong> is the &quot;payload&quot;—the actual instructions that execute the malicious intent. However, raw shellcode is incredibly easy for Antivirus (AV) and Endpoint Detection and Response (EDR) systems to spot because it contains predictable patterns and recognizable strings.</p>
<p>To stay invisible, developers use encryption. By encrypting the shellcode, you transform it into <strong>high-entropy data</strong> that looks like random noise. This bypasses static signature scanning, ensuring the payload remains &quot;dead&quot; and unreadable until it is decrypted directly into memory at runtime.</p>
<hr>
<h3>The Evolution of Hiding Techniques</h3>
<p>Different algorithms offer different trade-offs between stealth, complexity, and file size. Here are the common methods used to wrap shellcode:</p>
<ul>
<li><strong>XOR (The Classic):</strong> The simplest form of obfuscation. It’s fast and doesn’t require complex libraries, though simple versions are easily &quot;brute-forced&quot; by modern scanners.</li>
<li><strong>RC4 (The Stealthy Stream):</strong> A favorite for many years because it can be implemented using native Windows APIs (like <code>SystemFunction032</code>), allowing the dev to hide the decryption logic within legitimate system calls.</li>
<li><strong>AES (The Heavyweight):</strong> Provides high security and is very difficult to detect via entropy analysis, though it requires a larger code footprint to implement the full algorithm.</li>
</ul>
<hr>
<h3>Implementation References</h3>
<p>For those looking at how these are structured in code, check out the following implementations:</p>
<ul>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/XOR%201%20Key/">XOR 1 Key</a></strong> – Basic single-byte XOR rotation.</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/XOR%20KEYS/">XOR KEYS</a></strong> – Multi-byte or rolling key XOR for increased complexity.</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/RC4%20Native%20API/">RC4 Native API</a></strong> – Leveraging built-in Windows functions to decrypt data.</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/AES%20tiny/">AES tiny</a></strong> – A minimal C implementation of the Advanced Encryption Standard.</li>
</ul>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/Malware DEV/Encryption/AES tiny/" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">Shellcode Encryption with Tiny AES</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Execution/Execution/">Shellcode Execution & Injection Strategies</a></li><li><a href="/writeups/Malware DEV/Execution/Local Payload Execution/">Local Payload Execution</a></li><li><a href="/writeups/Malware DEV/Obfuscation/Obfuscation/">The Art of Obfuscation</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>(function(){function _0x1394df(_0x2ad2af){const _0x2e177f=_0x2ad2af||document['querySelector']('.writeup-content')||document,_0x299890=Array['from'](_0x2e177f['querySelectorAll']('pre\x20>\x20code'))['filter'](_0x224a77=>!_0x224a77['closest']('.code-block'));_0x299890['forEach'](_0xc88bf=>{const _0xd6d347=_0xc88bf['parentElement'];if(!_0xd6d347||_0xd6d347['dataset']['enhanced']==='true')return;_0xd6d347['dataset']['enhanced']='true';let _0x47f73f=Array['from'](_0xc88bf['classList']||[])['find'](_0x483426=>_0x483426['startsWith']('language-'));if(!_0x47f73f){const _0x283faf=_0xc88bf['textContent']||'';(/#include\s+<[^>]+>/['test'](_0x283faf)||/\bint\s+main\s*\(/['test'](_0x283faf)||/#include\s+<Windows\.h>/i['test'](_0x283faf))&&(_0xc88bf['classList']['add']('language-c'),_0x47f73f='language-c');}const _0x147841=(_0x47f73f?_0x47f73f['replace']('language-',''):'text')['toUpperCase'](),_0x2461c0=document['createElement']('div');_0x2461c0['className']='code-block';const _0xfcaccb=document['createElement']('div');_0xfcaccb['className']='code-header';const _0x267e18=document['createElement']('span');_0x267e18['className']='code-lang',_0x267e18['textContent']=_0x147841;const _0x250069=document['createElement']('button');_0x250069['className']='code-copy',_0x250069['type']='button',_0x250069['textContent']='Copy',_0x250069['addEventListener']('click',async()=>{const _0x56e105=_0xc88bf['innerText'],_0xf46137=()=>{const _0x2e123b=document['createElement']('textarea');_0x2e123b['value']=_0x56e105,_0x2e123b['style']['position']='fixed',_0x2e123b['style']['opacity']='0',_0x2e123b['style']['left']='-9999px',document['body']['appendChild'](_0x2e123b),_0x2e123b['focus'](),_0x2e123b['select']();try{document['execCommand']('copy'),_0x250069['textContent']='Copied';}catch(_0x4f88be){_0x250069['textContent']='Failed';}finally{document['body']['removeChild'](_0x2e123b),setTimeout(()=>_0x250069['textContent']='Copy',0x4b0);}};try{navigator['clipboard']&&window['isSecureContext']?(await navigator['clipboard']['writeText'](_0x56e105),_0x250069['textContent']='Copied',setTimeout(()=>_0x250069['textContent']='Copy',0x4b0)):_0xf46137();}catch(_0x598450){_0xf46137();}}),_0xfcaccb['appendChild'](_0x267e18),_0xfcaccb['appendChild'](_0x250069);const _0x2fd9ce=document['createElement']('div');_0x2fd9ce['className']='code-content',_0xd6d347['replaceWith'](_0x2461c0),_0x2fd9ce['appendChild'](_0xd6d347),_0x2461c0['appendChild'](_0xfcaccb),_0x2461c0['appendChild'](_0x2fd9ce);if(window['hljs']&&typeof window['hljs']['highlightElement']==='function')window['hljs']['highlightElement'](_0xc88bf);else window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});}function _0x53438f(_0x3a3c6a){const _0x1aae5d=_0x3a3c6a||document['querySelector']('.writeup-content');if(!_0x1aae5d)return;const _0x352a91=_0x1aae5d['querySelectorAll']('h1,h2,h3,h4,h5,h6');_0x352a91['forEach'](_0x3b733b=>{const _0x3811b5=parseInt(_0x3b733b['tagName']['substring'](0x1),0xa);let _0x259fca=_0x3b733b['nextElementSibling'];while(_0x259fca){if(/^H[1-6]$/['test'](_0x259fca['tagName'])){const _0x1e4957=parseInt(_0x259fca['tagName']['substring'](0x1),0xa);if(_0x1e4957<=_0x3811b5)break;}_0x259fca['tagName']==='P'&&_0x259fca['classList']['add']('indent-p'),_0x259fca=_0x259fca['nextElementSibling'];}});}function _0x4c383a(){window['mermaid']&&mermaid['initialize']({'startOnLoad':!![],'theme':'dark'});_0x1394df(),_0x53438f();window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();const _0x5b52d0=document['querySelector']('.writeup-content');if(_0x5b52d0&&window['MutationObserver']){const _0x5e3e54=new MutationObserver(()=>{_0x1394df(_0x5b52d0),_0x53438f(_0x5b52d0),window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});_0x5e3e54['observe'](_0x5b52d0,{'childList':!![],'subtree':!![]});}}window['addEventListener']('load',_0x4c383a);}());</script>
</body>
</html>
