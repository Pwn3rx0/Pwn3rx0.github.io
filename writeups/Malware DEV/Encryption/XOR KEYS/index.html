<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Multi-Key XOR Encryption - pwn3rx0</title>
  <meta name="description" content="A guide to implementing multi-byte XOR encryption for shellcode payloads, providing better entropy and resistance to simple brute-forcing compared to single-byte methods.">
  <meta name="keywords" content="malware-development, cryptography, xor, obfuscation, evasion, include, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, shellcode, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev, encryption">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/Encryption/XOR KEYS/">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Multi-Key XOR Encryption">
  <meta property="og:description" content="A guide to implementing multi-byte XOR encryption for shellcode payloads, providing better entropy and resistance to simple brute-forcing compared to single-byte methods.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/Encryption/XOR KEYS/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Multi-Key XOR Encryption">
  <meta name="twitter:description" content="A guide to implementing multi-byte XOR encryption for shellcode payloads, providing better entropy and resistance to simple brute-forcing compared to single-byte methods.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/Encryption/">Encryption</a>
    
      <span class="separator">/</span>
      <span class="current">Multi-Key XOR Encryption</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Multi-Key XOR Encryption</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">malware-development</span><span class="tag">cryptography</span><span class="tag">xor</span><span class="tag">obfuscation</span><span class="tag">evasion</span><span class="tag">include</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><h1>XOR with Multiple Keys</h1>
<ul>
<li><strong>Multi-key XOR</strong> uses a sequence of key bytes instead of a single key.</li>
<li>Each byte of data is XORed with a corresponding key byte in a repeating cycle.</li>
<li>This makes the encryption slightly stronger than single-key XOR.</li>
<li>Like single-key XOR, applying the same keys again restores the original data.</li>
</ul>
<hr>
<h3>Example C Code: XOR Shellcode with Multiple Keys</h3>
<pre><code class="language-c">#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

// Function to XOR shellcode with multiple key bytes in a loop
VOID XorByKeys(PBYTE pShellCode, SIZE_T sShellCodeSize, PBYTE bKeys, SIZE_T sKeySize) {
    for (int i = 0, j = 0; i &lt; sShellCodeSize; i++, j++) {
        if (j &gt;= sKeySize) {
            j = 0;  // Restart key index when it reaches key length
        }
        pShellCode[i] = pShellCode[i] ^ bKeys[j];
    }
};

unsigned char keys[] = {0x52, 0x98, 0x33, 0x77};
unsigned char shellcode[] = {
    0xfc,0x48,0x83,0xe4,0xf0,0xe8,
    0xc0,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52,0x51,0x56,0x48,
    0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48,
    0x8b,0x52,0x20,0x48,0x8b,0x72,0x50,0x48,0x0f,0xb7,0x4a,0x4a,
    0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c
};

int main() {
    XorByKeys(shellcode, sizeof(shellcode), keys, sizeof(keys));
    return 0;
}
</code></pre>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/Malware DEV/Encryption/AES tiny/" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">Shellcode Encryption with Tiny AES</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Obfuscation/Obfuscation/">The Art of Obfuscation</a></li><li><a href="/writeups/Malware DEV/Obfuscation/To IPs/">IPv4 Masquerading (Obfuscation)</a></li><li><a href="/writeups/Malware DEV/Execution/Execution/">Shellcode Execution & Injection Strategies</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>(function(){function _0x4246e6(_0x3a6aa5){const _0x52a487=_0x3a6aa5||document['querySelector']('.writeup-content')||document,_0x1f3c30=Array['from'](_0x52a487['querySelectorAll']('pre\x20>\x20code'))['filter'](_0xb12c8c=>!_0xb12c8c['closest']('.code-block'));_0x1f3c30['forEach'](_0x11273b=>{const _0x43307d=_0x11273b['parentElement'];if(!_0x43307d||_0x43307d['dataset']['enhanced']==='true')return;_0x43307d['dataset']['enhanced']='true';let _0x408450=Array['from'](_0x11273b['classList']||[])['find'](_0x5750de=>_0x5750de['startsWith']('language-'));if(!_0x408450){const _0x3138b3=_0x11273b['textContent']||'';(/#include\s+<[^>]+>/['test'](_0x3138b3)||/\bint\s+main\s*\(/['test'](_0x3138b3)||/#include\s+<Windows\.h>/i['test'](_0x3138b3))&&(_0x11273b['classList']['add']('language-c'),_0x408450='language-c');}const _0x2a9284=(_0x408450?_0x408450['replace']('language-',''):'text')['toUpperCase'](),_0x578140=document['createElement']('div');_0x578140['className']='code-block';const _0x33d700=document['createElement']('div');_0x33d700['className']='code-header';const _0x13b57e=document['createElement']('span');_0x13b57e['className']='code-lang',_0x13b57e['textContent']=_0x2a9284;const _0x47982a=document['createElement']('button');_0x47982a['className']='code-copy',_0x47982a['type']='button',_0x47982a['textContent']='Copy',_0x47982a['addEventListener']('click',async()=>{const _0x4694f7=_0x11273b['innerText'],_0x1c9b03=()=>{const _0x3f535a=document['createElement']('textarea');_0x3f535a['value']=_0x4694f7,_0x3f535a['style']['position']='fixed',_0x3f535a['style']['opacity']='0',_0x3f535a['style']['left']='-9999px',document['body']['appendChild'](_0x3f535a),_0x3f535a['focus'](),_0x3f535a['select']();try{document['execCommand']('copy'),_0x47982a['textContent']='Copied';}catch(_0x10bd0f){_0x47982a['textContent']='Failed';}finally{document['body']['removeChild'](_0x3f535a),setTimeout(()=>_0x47982a['textContent']='Copy',0x4b0);}};try{navigator['clipboard']&&window['isSecureContext']?(await navigator['clipboard']['writeText'](_0x4694f7),_0x47982a['textContent']='Copied',setTimeout(()=>_0x47982a['textContent']='Copy',0x4b0)):_0x1c9b03();}catch(_0x50e7c0){_0x1c9b03();}}),_0x33d700['appendChild'](_0x13b57e),_0x33d700['appendChild'](_0x47982a);const _0x4a5156=document['createElement']('div');_0x4a5156['className']='code-content',_0x43307d['replaceWith'](_0x578140),_0x4a5156['appendChild'](_0x43307d),_0x578140['appendChild'](_0x33d700),_0x578140['appendChild'](_0x4a5156);if(window['hljs']&&typeof window['hljs']['highlightElement']==='function')window['hljs']['highlightElement'](_0x11273b);else window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});}function _0x5adc19(_0x5e175b){const _0x543ffb=_0x5e175b||document['querySelector']('.writeup-content');if(!_0x543ffb)return;const _0x299bdb=_0x543ffb['querySelectorAll']('h1,h2,h3,h4,h5,h6');_0x299bdb['forEach'](_0x6081a8=>{const _0x652831=parseInt(_0x6081a8['tagName']['substring'](0x1),0xa);let _0x4ab454=_0x6081a8['nextElementSibling'];while(_0x4ab454){if(/^H[1-6]$/['test'](_0x4ab454['tagName'])){const _0x1d93db=parseInt(_0x4ab454['tagName']['substring'](0x1),0xa);if(_0x1d93db<=_0x652831)break;}_0x4ab454['tagName']==='P'&&_0x4ab454['classList']['add']('indent-p'),_0x4ab454=_0x4ab454['nextElementSibling'];}});}function _0x52c71b(){window['mermaid']&&mermaid['initialize']({'startOnLoad':!![],'theme':'dark'});_0x4246e6(),_0x5adc19();window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();const _0x3d1cb2=document['querySelector']('.writeup-content');if(_0x3d1cb2&&window['MutationObserver']){const _0x342818=new MutationObserver(()=>{_0x4246e6(_0x3d1cb2),_0x5adc19(_0x3d1cb2),window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});_0x342818['observe'](_0x3d1cb2,{'childList':!![],'subtree':!![]});}}window['addEventListener']('load',_0x52c71b);}());</script>
</body>
</html>
