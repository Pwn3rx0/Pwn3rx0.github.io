<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Multi-Key XOR Encryption - pwn3rx0</title>
  <meta name="description" content="A guide to implementing multi-byte XOR encryption for shellcode payloads, providing better entropy and resistance to simple brute-forcing compared to single-byte methods.">
  <meta name="keywords" content="malware-development, cryptography, xor, obfuscation, evasion, include, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, shellcode, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev, encryption">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/Encryption/XOR KEYS/">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Multi-Key XOR Encryption">
  <meta property="og:description" content="A guide to implementing multi-byte XOR encryption for shellcode payloads, providing better entropy and resistance to simple brute-forcing compared to single-byte methods.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/Encryption/XOR KEYS/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Multi-Key XOR Encryption">
  <meta name="twitter:description" content="A guide to implementing multi-byte XOR encryption for shellcode payloads, providing better entropy and resistance to simple brute-forcing compared to single-byte methods.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/Encryption/">Encryption</a>
    
      <span class="separator">/</span>
      <span class="current">Multi-Key XOR Encryption</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Multi-Key XOR Encryption</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">malware-development</span><span class="tag">cryptography</span><span class="tag">xor</span><span class="tag">obfuscation</span><span class="tag">evasion</span><span class="tag">include</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><h1>XOR with Multiple Keys</h1>
<ul>
<li><strong>Multi-key XOR</strong> uses a sequence of key bytes instead of a single key.</li>
<li>Each byte of data is XORed with a corresponding key byte in a repeating cycle.</li>
<li>This makes the encryption slightly stronger than single-key XOR.</li>
<li>Like single-key XOR, applying the same keys again restores the original data.</li>
</ul>
<hr>
<h3>Example C Code: XOR Shellcode with Multiple Keys</h3>
<pre><code class="language-c">#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

// Function to XOR shellcode with multiple key bytes in a loop
VOID XorByKeys(PBYTE pShellCode, SIZE_T sShellCodeSize, PBYTE bKeys, SIZE_T sKeySize) {
    for (int i = 0, j = 0; i &lt; sShellCodeSize; i++, j++) {
        if (j &gt;= sKeySize) {
            j = 0;  // Restart key index when it reaches key length
        }
        pShellCode[i] = pShellCode[i] ^ bKeys[j];
    }
};

unsigned char keys[] = {0x52, 0x98, 0x33, 0x77};
unsigned char shellcode[] = {
    0xfc,0x48,0x83,0xe4,0xf0,0xe8,
    0xc0,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52,0x51,0x56,0x48,
    0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48,
    0x8b,0x52,0x20,0x48,0x8b,0x72,0x50,0x48,0x0f,0xb7,0x4a,0x4a,
    0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c
};

int main() {
    XorByKeys(shellcode, sizeof(shellcode), keys, sizeof(keys));
    return 0;
}
</code></pre>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/Malware DEV/Encryption/AES tiny/" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">Shellcode Encryption with Tiny AES</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Obfuscation/Obfuscation/">The Art of Obfuscation</a></li><li><a href="/writeups/Malware DEV/Obfuscation/To IPs/">IPv4 Masquerading (Obfuscation)</a></li><li><a href="/writeups/Malware DEV/Execution/Execution/">Shellcode Execution & Injection Strategies</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>(function(){function _0x1d578c(_0x3678ba){const _0x1b3c71=_0x3678ba||document['querySelector']('.writeup-content')||document,_0x484b44=Array['from'](_0x1b3c71['querySelectorAll']('pre\x20>\x20code'))['filter'](_0x4dac3e=>!_0x4dac3e['closest']('.code-block'));_0x484b44['forEach'](_0x2a47ee=>{const _0x4d6983=_0x2a47ee['parentElement'];if(!_0x4d6983||_0x4d6983['dataset']['enhanced']==='true')return;_0x4d6983['dataset']['enhanced']='true';let _0x575f88=Array['from'](_0x2a47ee['classList']||[])['find'](_0x4b291e=>_0x4b291e['startsWith']('language-'));if(!_0x575f88){const _0x3fd661=_0x2a47ee['textContent']||'';(/#include\s+<[^>]+>/['test'](_0x3fd661)||/\bint\s+main\s*\(/['test'](_0x3fd661)||/#include\s+<Windows\.h>/i['test'](_0x3fd661))&&(_0x2a47ee['classList']['add']('language-c'),_0x575f88='language-c');}const _0x59c722=(_0x575f88?_0x575f88['replace']('language-',''):'text')['toUpperCase'](),_0x575c71=document['createElement']('div');_0x575c71['className']='code-block';const _0x35d62e=document['createElement']('div');_0x35d62e['className']='code-header';const _0x1b2741=document['createElement']('span');_0x1b2741['className']='code-lang',_0x1b2741['textContent']=_0x59c722;const _0x38fbeb=document['createElement']('button');_0x38fbeb['className']='code-copy',_0x38fbeb['type']='button',_0x38fbeb['textContent']='Copy',_0x38fbeb['addEventListener']('click',async()=>{const _0x120aa0=_0x2a47ee['innerText'],_0x4c6602=()=>{const _0x41aa85=document['createElement']('textarea');_0x41aa85['value']=_0x120aa0,_0x41aa85['style']['position']='fixed',_0x41aa85['style']['opacity']='0',_0x41aa85['style']['left']='-9999px',document['body']['appendChild'](_0x41aa85),_0x41aa85['focus'](),_0x41aa85['select']();try{document['execCommand']('copy'),_0x38fbeb['textContent']='Copied';}catch(_0x4b91e4){_0x38fbeb['textContent']='Failed';}finally{document['body']['removeChild'](_0x41aa85),setTimeout(()=>_0x38fbeb['textContent']='Copy',0x4b0);}};try{navigator['clipboard']&&window['isSecureContext']?(await navigator['clipboard']['writeText'](_0x120aa0),_0x38fbeb['textContent']='Copied',setTimeout(()=>_0x38fbeb['textContent']='Copy',0x4b0)):_0x4c6602();}catch(_0x55575d){_0x4c6602();}}),_0x35d62e['appendChild'](_0x1b2741),_0x35d62e['appendChild'](_0x38fbeb);const _0x2c15d0=document['createElement']('div');_0x2c15d0['className']='code-content',_0x4d6983['replaceWith'](_0x575c71),_0x2c15d0['appendChild'](_0x4d6983),_0x575c71['appendChild'](_0x35d62e),_0x575c71['appendChild'](_0x2c15d0);if(window['hljs']&&typeof window['hljs']['highlightElement']==='function')window['hljs']['highlightElement'](_0x2a47ee);else window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});}function _0x546bfa(_0x2c4b25){const _0x5a8145=_0x2c4b25||document['querySelector']('.writeup-content');if(!_0x5a8145)return;const _0x42b1ad=_0x5a8145['querySelectorAll']('h1,h2,h3,h4,h5,h6');_0x42b1ad['forEach'](_0x106829=>{const _0x4fe60c=parseInt(_0x106829['tagName']['substring'](0x1),0xa);let _0x337aea=_0x106829['nextElementSibling'];while(_0x337aea){if(/^H[1-6]$/['test'](_0x337aea['tagName'])){const _0x3333d3=parseInt(_0x337aea['tagName']['substring'](0x1),0xa);if(_0x3333d3<=_0x4fe60c)break;}_0x337aea['tagName']==='P'&&_0x337aea['classList']['add']('indent-p'),_0x337aea=_0x337aea['nextElementSibling'];}});}function _0x10818c(){window['mermaid']&&mermaid['initialize']({'startOnLoad':!![],'theme':'dark'});_0x1d578c(),_0x546bfa();window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();const _0x1c3d4f=document['querySelector']('.writeup-content');if(_0x1c3d4f&&window['MutationObserver']){const _0x133358=new MutationObserver(()=>{_0x1d578c(_0x1c3d4f),_0x546bfa(_0x1c3d4f),window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});_0x133358['observe'](_0x1c3d4f,{'childList':!![],'subtree':!![]});}}window['addEventListener']('load',_0x10818c);}());</script>
</body>
</html>
