<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Multi-Key XOR Encryption - pwn3rx0</title>
  <meta name="description" content="A guide to implementing multi-byte XOR encryption for shellcode payloads, providing better entropy and resistance to simple brute-forcing compared to single-byte methods.">
  <meta name="keywords" content="malware-development, cryptography, xor, obfuscation, evasion, include, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, shellcode, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev, encryption">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/Encryption/XOR KEYS/">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Multi-Key XOR Encryption">
  <meta property="og:description" content="A guide to implementing multi-byte XOR encryption for shellcode payloads, providing better entropy and resistance to simple brute-forcing compared to single-byte methods.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/Encryption/XOR KEYS/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Multi-Key XOR Encryption">
  <meta name="twitter:description" content="A guide to implementing multi-byte XOR encryption for shellcode payloads, providing better entropy and resistance to simple brute-forcing compared to single-byte methods.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/Encryption/">Encryption</a>
    
      <span class="separator">/</span>
      <span class="current">Multi-Key XOR Encryption</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Multi-Key XOR Encryption</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">malware-development</span><span class="tag">cryptography</span><span class="tag">xor</span><span class="tag">obfuscation</span><span class="tag">evasion</span><span class="tag">include</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><h1>XOR with Multiple Keys</h1>
<ul>
<li><strong>Multi-key XOR</strong> uses a sequence of key bytes instead of a single key.</li>
<li>Each byte of data is XORed with a corresponding key byte in a repeating cycle.</li>
<li>This makes the encryption slightly stronger than single-key XOR.</li>
<li>Like single-key XOR, applying the same keys again restores the original data.</li>
</ul>
<hr>
<h3>Example C Code: XOR Shellcode with Multiple Keys</h3>
<pre><code class="language-c">#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

// Function to XOR shellcode with multiple key bytes in a loop
VOID XorByKeys(PBYTE pShellCode, SIZE_T sShellCodeSize, PBYTE bKeys, SIZE_T sKeySize) {
    for (int i = 0, j = 0; i &lt; sShellCodeSize; i++, j++) {
        if (j &gt;= sKeySize) {
            j = 0;  // Restart key index when it reaches key length
        }
        pShellCode[i] = pShellCode[i] ^ bKeys[j];
    }
};

unsigned char keys[] = {0x52, 0x98, 0x33, 0x77};
unsigned char shellcode[] = {
    0xfc,0x48,0x83,0xe4,0xf0,0xe8,
    0xc0,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52,0x51,0x56,0x48,
    0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48,
    0x8b,0x52,0x20,0x48,0x8b,0x72,0x50,0x48,0x0f,0xb7,0x4a,0x4a,
    0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c
};

int main() {
    XorByKeys(shellcode, sizeof(shellcode), keys, sizeof(keys));
    return 0;
}
</code></pre>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/Malware DEV/Encryption/AES tiny/" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">Shellcode Encryption with Tiny AES</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Obfuscation/Obfuscation/">The Art of Obfuscation</a></li><li><a href="/writeups/Malware DEV/Obfuscation/To IPs/">IPv4 Masquerading (Obfuscation)</a></li><li><a href="/writeups/Malware DEV/Execution/Execution/">Shellcode Execution & Injection Strategies</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>(function(){function _0x507052(_0xab0221){const _0xb49752=_0xab0221||document['querySelector']('.writeup-content')||document,_0x15ad60=Array['from'](_0xb49752['querySelectorAll']('pre\x20>\x20code'))['filter'](_0x133f81=>!_0x133f81['closest']('.code-block'));_0x15ad60['forEach'](_0x3805eb=>{const _0x49c408=_0x3805eb['parentElement'];if(!_0x49c408||_0x49c408['dataset']['enhanced']==='true')return;_0x49c408['dataset']['enhanced']='true';let _0x1a55a5=Array['from'](_0x3805eb['classList']||[])['find'](_0x25351f=>_0x25351f['startsWith']('language-'));if(!_0x1a55a5){const _0x3ba11e=_0x3805eb['textContent']||'';(/#include\s+<[^>]+>/['test'](_0x3ba11e)||/\bint\s+main\s*\(/['test'](_0x3ba11e)||/#include\s+<Windows\.h>/i['test'](_0x3ba11e))&&(_0x3805eb['classList']['add']('language-c'),_0x1a55a5='language-c');}const _0x3ea5d1=(_0x1a55a5?_0x1a55a5['replace']('language-',''):'text')['toUpperCase'](),_0x2a2a74=document['createElement']('div');_0x2a2a74['className']='code-block';const _0x8d9989=document['createElement']('div');_0x8d9989['className']='code-header';const _0x3f0379=document['createElement']('span');_0x3f0379['className']='code-lang',_0x3f0379['textContent']=_0x3ea5d1;const _0x129a8c=document['createElement']('button');_0x129a8c['className']='code-copy',_0x129a8c['type']='button',_0x129a8c['textContent']='Copy',_0x129a8c['addEventListener']('click',async()=>{const _0x35862b=_0x3805eb['innerText'],_0x4c11a5=()=>{const _0xfc945e=document['createElement']('textarea');_0xfc945e['value']=_0x35862b,_0xfc945e['style']['position']='fixed',_0xfc945e['style']['opacity']='0',_0xfc945e['style']['left']='-9999px',document['body']['appendChild'](_0xfc945e),_0xfc945e['focus'](),_0xfc945e['select']();try{document['execCommand']('copy'),_0x129a8c['textContent']='Copied';}catch(_0x44d9bd){_0x129a8c['textContent']='Failed';}finally{document['body']['removeChild'](_0xfc945e),setTimeout(()=>_0x129a8c['textContent']='Copy',0x4b0);}};try{navigator['clipboard']&&window['isSecureContext']?(await navigator['clipboard']['writeText'](_0x35862b),_0x129a8c['textContent']='Copied',setTimeout(()=>_0x129a8c['textContent']='Copy',0x4b0)):_0x4c11a5();}catch(_0x40fe64){_0x4c11a5();}}),_0x8d9989['appendChild'](_0x3f0379),_0x8d9989['appendChild'](_0x129a8c);const _0x17c487=document['createElement']('div');_0x17c487['className']='code-content',_0x49c408['replaceWith'](_0x2a2a74),_0x17c487['appendChild'](_0x49c408),_0x2a2a74['appendChild'](_0x8d9989),_0x2a2a74['appendChild'](_0x17c487);if(window['hljs']&&typeof window['hljs']['highlightElement']==='function')window['hljs']['highlightElement'](_0x3805eb);else window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});}function _0x19ac77(_0x18d8ae){const _0x9354cf=_0x18d8ae||document['querySelector']('.writeup-content');if(!_0x9354cf)return;const _0x1f4af9=_0x9354cf['querySelectorAll']('h1,h2,h3,h4,h5,h6');_0x1f4af9['forEach'](_0x1d995a=>{const _0x43738f=parseInt(_0x1d995a['tagName']['substring'](0x1),0xa);let _0x1ab7bb=_0x1d995a['nextElementSibling'];while(_0x1ab7bb){if(/^H[1-6]$/['test'](_0x1ab7bb['tagName'])){const _0x1001cc=parseInt(_0x1ab7bb['tagName']['substring'](0x1),0xa);if(_0x1001cc<=_0x43738f)break;}_0x1ab7bb['tagName']==='P'&&_0x1ab7bb['classList']['add']('indent-p'),_0x1ab7bb=_0x1ab7bb['nextElementSibling'];}});}function _0x2515dc(){window['mermaid']&&mermaid['initialize']({'startOnLoad':!![],'theme':'dark'});_0x507052(),_0x19ac77();window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();const _0x35d387=document['querySelector']('.writeup-content');if(_0x35d387&&window['MutationObserver']){const _0x126ded=new MutationObserver(()=>{_0x507052(_0x35d387),_0x19ac77(_0x35d387),window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});_0x126ded['observe'](_0x35d387,{'childList':!![],'subtree':!![]});}}window['addEventListener']('load',_0x2515dc);}());</script>
</body>
</html>
