<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Local DLL Execution - pwn3rx0</title>
  <meta name="description" content="A practical guide to dynamically loading and executing DLLs locally using LoadLibraryA, including a breakdown of the DllMain entry point and execution flow.">
  <meta name="keywords" content="malware-development, windows-internals, dll-loading, win-api, execution, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, shellcode, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/Execution/Local Dll Execution/">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Local DLL Execution">
  <meta property="og:description" content="A practical guide to dynamically loading and executing DLLs locally using LoadLibraryA, including a breakdown of the DllMain entry point and execution flow.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/Execution/Local Dll Execution/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Local DLL Execution">
  <meta name="twitter:description" content="A practical guide to dynamically loading and executing DLLs locally using LoadLibraryA, including a breakdown of the DllMain entry point and execution flow.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/Execution/">Execution</a>
    
      <span class="separator">/</span>
      <span class="current">Local DLL Execution</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Local DLL Execution</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">malware-development</span><span class="tag">windows-internals</span><span class="tag">dll-loading</span><span class="tag">win-api</span><span class="tag">execution</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><p>Local DLL Execution is a technique in which a compiled executable dynamically loads a Dynamic-Link Library (DLL) at runtime. This is commonly used for modularizing code or for various security and testing purposes. However, it can also be exploited in offensive or defensive security contexts.</p>
<hr>
<h2>Execution Code:</h2>
<p>The following C program demonstrates how to load a DLL dynamically using <code>LoadLibraryA</code>:</p>
<pre><code class="language-c">#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

int main(int argc, char* argv[]) {
    if (argc &lt; 2) {
        printf(&quot;\n[-] Missing the DLL name\n&quot;);
        return -1;
    }
    if (LoadLibraryA(argv[1]) == NULL) {
        printf(&quot;[-] Failed to load DLL: %s (Error Code: %lu)\n&quot;, argv[1], GetLastError());
        return -1;
    }
    printf(&quot;[+] DLL loaded successfully: %s\n&quot;, argv[1]);
    return 0;
}
</code></pre>
<h3>Usage:</h3>
<p>Compile the above code and run:</p>
<pre><code class="language-cmd">DllExecuter.exe your.dll
</code></pre>
<p>This loads the specified DLL into the process memory space.</p>
<hr>
<h2>DLL Code (Payload)</h2>
<p>The following is the DLL that triggers a message box when loaded:</p>
<pre><code class="language-c">#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

BOOL APIENTRY DllMain(HMODULE hModule, DWORD ul_reason_for_call, LPVOID lpReserved) {
    switch (ul_reason_for_call) {
    case DLL_PROCESS_ATTACH:
        MessageBox(NULL, L&quot;hi&quot;, L&quot;test&quot;, MB_OK);
        break;
    case DLL_THREAD_ATTACH:
    case DLL_THREAD_DETACH:
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}
</code></pre>
<h3>Behavior:</h3>
<p>Upon successful loading, the <code>DLL_PROCESS_ATTACH</code> event is triggered, showing a message box to confirm execution.</p>
<hr>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/Malware DEV/Execution/APC Injection/" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">APC Injection</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Encryption/RC4 Native API/">RC4 Stream Cipher (Native API)</a></li><li><a href="/writeups/Malware DEV/Make Malware/">Modular Malware Development & Defense Evasion</a></li><li><a href="/writeups/Malware DEV/Obfuscation/To IPs/">IPv4 Masquerading (Obfuscation)</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>(function(){function _0x599a28(_0x3d9c0f){const _0x725e39=_0x3d9c0f||document['querySelector']('.writeup-content')||document,_0x485eea=Array['from'](_0x725e39['querySelectorAll']('pre\x20>\x20code'))['filter'](_0x5a5d14=>!_0x5a5d14['closest']('.code-block'));_0x485eea['forEach'](_0x17213a=>{const _0x2fdc04=_0x17213a['parentElement'];if(!_0x2fdc04||_0x2fdc04['dataset']['enhanced']==='true')return;_0x2fdc04['dataset']['enhanced']='true';let _0x3d5442=Array['from'](_0x17213a['classList']||[])['find'](_0xe38cfc=>_0xe38cfc['startsWith']('language-'));if(!_0x3d5442){const _0x140663=_0x17213a['textContent']||'';(/#include\s+<[^>]+>/['test'](_0x140663)||/\bint\s+main\s*\(/['test'](_0x140663)||/#include\s+<Windows\.h>/i['test'](_0x140663))&&(_0x17213a['classList']['add']('language-c'),_0x3d5442='language-c');}const _0x2fa3b5=(_0x3d5442?_0x3d5442['replace']('language-',''):'text')['toUpperCase'](),_0x148a10=document['createElement']('div');_0x148a10['className']='code-block';const _0x5ba1f9=document['createElement']('div');_0x5ba1f9['className']='code-header';const _0x1dc078=document['createElement']('span');_0x1dc078['className']='code-lang',_0x1dc078['textContent']=_0x2fa3b5;const _0xf9a9f1=document['createElement']('button');_0xf9a9f1['className']='code-copy',_0xf9a9f1['type']='button',_0xf9a9f1['textContent']='Copy',_0xf9a9f1['addEventListener']('click',async()=>{const _0x104eb8=_0x17213a['innerText'],_0x9c0a0d=()=>{const _0x742c92=document['createElement']('textarea');_0x742c92['value']=_0x104eb8,_0x742c92['style']['position']='fixed',_0x742c92['style']['opacity']='0',_0x742c92['style']['left']='-9999px',document['body']['appendChild'](_0x742c92),_0x742c92['focus'](),_0x742c92['select']();try{document['execCommand']('copy'),_0xf9a9f1['textContent']='Copied';}catch(_0x66aa65){_0xf9a9f1['textContent']='Failed';}finally{document['body']['removeChild'](_0x742c92),setTimeout(()=>_0xf9a9f1['textContent']='Copy',0x4b0);}};try{navigator['clipboard']&&window['isSecureContext']?(await navigator['clipboard']['writeText'](_0x104eb8),_0xf9a9f1['textContent']='Copied',setTimeout(()=>_0xf9a9f1['textContent']='Copy',0x4b0)):_0x9c0a0d();}catch(_0x15483b){_0x9c0a0d();}}),_0x5ba1f9['appendChild'](_0x1dc078),_0x5ba1f9['appendChild'](_0xf9a9f1);const _0x2e5412=document['createElement']('div');_0x2e5412['className']='code-content',_0x2fdc04['replaceWith'](_0x148a10),_0x2e5412['appendChild'](_0x2fdc04),_0x148a10['appendChild'](_0x5ba1f9),_0x148a10['appendChild'](_0x2e5412);if(window['hljs']&&typeof window['hljs']['highlightElement']==='function')window['hljs']['highlightElement'](_0x17213a);else window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});}function _0xca8eb3(_0x48601e){const _0x5c8035=_0x48601e||document['querySelector']('.writeup-content');if(!_0x5c8035)return;const _0x3ecc95=_0x5c8035['querySelectorAll']('h1,h2,h3,h4,h5,h6');_0x3ecc95['forEach'](_0x4c573c=>{const _0x221550=parseInt(_0x4c573c['tagName']['substring'](0x1),0xa);let _0x32ed1d=_0x4c573c['nextElementSibling'];while(_0x32ed1d){if(/^H[1-6]$/['test'](_0x32ed1d['tagName'])){const _0x2b9eaf=parseInt(_0x32ed1d['tagName']['substring'](0x1),0xa);if(_0x2b9eaf<=_0x221550)break;}_0x32ed1d['tagName']==='P'&&_0x32ed1d['classList']['add']('indent-p'),_0x32ed1d=_0x32ed1d['nextElementSibling'];}});}function _0x3bb15d(){window['mermaid']&&mermaid['initialize']({'startOnLoad':!![],'theme':'dark'});_0x599a28(),_0xca8eb3();window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();const _0x3fc66c=document['querySelector']('.writeup-content');if(_0x3fc66c&&window['MutationObserver']){const _0x1f59e2=new MutationObserver(()=>{_0x599a28(_0x3fc66c),_0xca8eb3(_0x3fc66c),window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});_0x1f59e2['observe'](_0x3fc66c,{'childList':!![],'subtree':!![]});}}window['addEventListener']('load',_0x3bb15d);}());</script>
</body>
</html>
