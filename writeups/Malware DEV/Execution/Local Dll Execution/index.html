<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Local DLL Execution - pwn3rx0</title>
  <meta name="description" content="A practical guide to dynamically loading and executing DLLs locally using LoadLibraryA, including a breakdown of the DllMain entry point and execution flow.">
  <meta name="keywords" content="malware-development, windows-internals, dll-loading, win-api, execution, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, shellcode, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/Execution/Local Dll Execution/">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Local DLL Execution">
  <meta property="og:description" content="A practical guide to dynamically loading and executing DLLs locally using LoadLibraryA, including a breakdown of the DllMain entry point and execution flow.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/Execution/Local Dll Execution/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Local DLL Execution">
  <meta name="twitter:description" content="A practical guide to dynamically loading and executing DLLs locally using LoadLibraryA, including a breakdown of the DllMain entry point and execution flow.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/Execution/">Execution</a>
    
      <span class="separator">/</span>
      <span class="current">Local DLL Execution</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Local DLL Execution</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">malware-development</span><span class="tag">windows-internals</span><span class="tag">dll-loading</span><span class="tag">win-api</span><span class="tag">execution</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><p>Local DLL Execution is a technique in which a compiled executable dynamically loads a Dynamic-Link Library (DLL) at runtime. This is commonly used for modularizing code or for various security and testing purposes. However, it can also be exploited in offensive or defensive security contexts.</p>
<hr>
<h2>Execution Code:</h2>
<p>The following C program demonstrates how to load a DLL dynamically using <code>LoadLibraryA</code>:</p>
<pre><code class="language-c">#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

int main(int argc, char* argv[]) {
    if (argc &lt; 2) {
        printf(&quot;\n[-] Missing the DLL name\n&quot;);
        return -1;
    }
    if (LoadLibraryA(argv[1]) == NULL) {
        printf(&quot;[-] Failed to load DLL: %s (Error Code: %lu)\n&quot;, argv[1], GetLastError());
        return -1;
    }
    printf(&quot;[+] DLL loaded successfully: %s\n&quot;, argv[1]);
    return 0;
}
</code></pre>
<h3>Usage:</h3>
<p>Compile the above code and run:</p>
<pre><code class="language-cmd">DllExecuter.exe your.dll
</code></pre>
<p>This loads the specified DLL into the process memory space.</p>
<hr>
<h2>DLL Code (Payload)</h2>
<p>The following is the DLL that triggers a message box when loaded:</p>
<pre><code class="language-c">#include &lt;Windows.h&gt;
#include &lt;stdio.h&gt;

BOOL APIENTRY DllMain(HMODULE hModule, DWORD ul_reason_for_call, LPVOID lpReserved) {
    switch (ul_reason_for_call) {
    case DLL_PROCESS_ATTACH:
        MessageBox(NULL, L&quot;hi&quot;, L&quot;test&quot;, MB_OK);
        break;
    case DLL_THREAD_ATTACH:
    case DLL_THREAD_DETACH:
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}
</code></pre>
<h3>Behavior:</h3>
<p>Upon successful loading, the <code>DLL_PROCESS_ATTACH</code> event is triggered, showing a message box to confirm execution.</p>
<hr>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/Malware DEV/Execution/APC Injection/" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">APC Injection</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Encryption/RC4 Native API/">RC4 Stream Cipher (Native API)</a></li><li><a href="/writeups/Malware DEV/Make Malware/">Modular Malware Development & Defense Evasion</a></li><li><a href="/writeups/Malware DEV/Obfuscation/To IPs/">IPv4 Masquerading (Obfuscation)</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>(function(){function _0x31711e(_0x3f514a){const _0xfc1a65=_0x3f514a||document['querySelector']('.writeup-content')||document,_0x17b567=Array['from'](_0xfc1a65['querySelectorAll']('pre\x20>\x20code'))['filter'](_0x3cb6b7=>!_0x3cb6b7['closest']('.code-block'));_0x17b567['forEach'](_0x4f40fd=>{const _0x24c73b=_0x4f40fd['parentElement'];if(!_0x24c73b||_0x24c73b['dataset']['enhanced']==='true')return;_0x24c73b['dataset']['enhanced']='true';let _0x2dd095=Array['from'](_0x4f40fd['classList']||[])['find'](_0x46bab1=>_0x46bab1['startsWith']('language-'));if(!_0x2dd095){const _0x51e25d=_0x4f40fd['textContent']||'';(/#include\s+<[^>]+>/['test'](_0x51e25d)||/\bint\s+main\s*\(/['test'](_0x51e25d)||/#include\s+<Windows\.h>/i['test'](_0x51e25d))&&(_0x4f40fd['classList']['add']('language-c'),_0x2dd095='language-c');}const _0x4e752a=(_0x2dd095?_0x2dd095['replace']('language-',''):'text')['toUpperCase'](),_0x1ca973=document['createElement']('div');_0x1ca973['className']='code-block';const _0x282bae=document['createElement']('div');_0x282bae['className']='code-header';const _0x16946b=document['createElement']('span');_0x16946b['className']='code-lang',_0x16946b['textContent']=_0x4e752a;const _0x7ee42e=document['createElement']('button');_0x7ee42e['className']='code-copy',_0x7ee42e['type']='button',_0x7ee42e['textContent']='Copy',_0x7ee42e['addEventListener']('click',async()=>{const _0x26cb09=_0x4f40fd['innerText'],_0x329849=()=>{const _0x2a6fcc=document['createElement']('textarea');_0x2a6fcc['value']=_0x26cb09,_0x2a6fcc['style']['position']='fixed',_0x2a6fcc['style']['opacity']='0',_0x2a6fcc['style']['left']='-9999px',document['body']['appendChild'](_0x2a6fcc),_0x2a6fcc['focus'](),_0x2a6fcc['select']();try{document['execCommand']('copy'),_0x7ee42e['textContent']='Copied';}catch(_0x3b5e9b){_0x7ee42e['textContent']='Failed';}finally{document['body']['removeChild'](_0x2a6fcc),setTimeout(()=>_0x7ee42e['textContent']='Copy',0x4b0);}};try{navigator['clipboard']&&window['isSecureContext']?(await navigator['clipboard']['writeText'](_0x26cb09),_0x7ee42e['textContent']='Copied',setTimeout(()=>_0x7ee42e['textContent']='Copy',0x4b0)):_0x329849();}catch(_0x75983c){_0x329849();}}),_0x282bae['appendChild'](_0x16946b),_0x282bae['appendChild'](_0x7ee42e);const _0x5d4792=document['createElement']('div');_0x5d4792['className']='code-content',_0x24c73b['replaceWith'](_0x1ca973),_0x5d4792['appendChild'](_0x24c73b),_0x1ca973['appendChild'](_0x282bae),_0x1ca973['appendChild'](_0x5d4792);if(window['hljs']&&typeof window['hljs']['highlightElement']==='function')window['hljs']['highlightElement'](_0x4f40fd);else window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});}function _0x34ad9f(_0x1f8a2c){const _0x493eaa=_0x1f8a2c||document['querySelector']('.writeup-content');if(!_0x493eaa)return;const _0x3dc307=_0x493eaa['querySelectorAll']('h1,h2,h3,h4,h5,h6');_0x3dc307['forEach'](_0x4c6054=>{const _0xbeac46=parseInt(_0x4c6054['tagName']['substring'](0x1),0xa);let _0x25a442=_0x4c6054['nextElementSibling'];while(_0x25a442){if(/^H[1-6]$/['test'](_0x25a442['tagName'])){const _0x31cb30=parseInt(_0x25a442['tagName']['substring'](0x1),0xa);if(_0x31cb30<=_0xbeac46)break;}_0x25a442['tagName']==='P'&&_0x25a442['classList']['add']('indent-p'),_0x25a442=_0x25a442['nextElementSibling'];}});}function _0x5dbfb3(){window['mermaid']&&mermaid['initialize']({'startOnLoad':!![],'theme':'dark'});_0x31711e(),_0x34ad9f();window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();const _0x240ddf=document['querySelector']('.writeup-content');if(_0x240ddf&&window['MutationObserver']){const _0x29c9c4=new MutationObserver(()=>{_0x31711e(_0x240ddf),_0x34ad9f(_0x240ddf),window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});_0x29c9c4['observe'](_0x240ddf,{'childList':!![],'subtree':!![]});}}window['addEventListener']('load',_0x5dbfb3);}());</script>
</body>
</html>
