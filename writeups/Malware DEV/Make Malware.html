<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modular Malware Development & Defense Evasion - pwn3rx0</title>
  <meta name="description" content="An introduction to the modular architecture of modern malware, focusing on the layers of encryption, obfuscation, and execution required to bypass EDR/AV solutions.">
  <meta name="keywords" content="malware-development, defense-evasion, red-team, cybersecurity, windows-internals, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, shellcode, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/Make Malware.html">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="Modular Malware Development & Defense Evasion">
  <meta property="og:description" content="An introduction to the modular architecture of modern malware, focusing on the layers of encryption, obfuscation, and execution required to bypass EDR/AV solutions.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/Make Malware.html">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Modular Malware Development & Defense Evasion">
  <meta name="twitter:description" content="An introduction to the modular architecture of modern malware, focusing on the layers of encryption, obfuscation, and execution required to bypass EDR/AV solutions.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV.html">Malware DEV</a>
    
      <span class="separator">/</span>
      <span class="current">Modular Malware Development & Defense Evasion</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>Modular Malware Development & Defense Evasion</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">malware-development</span><span class="tag">defense-evasion</span><span class="tag">red-team</span><span class="tag">cybersecurity</span><span class="tag">windows-internals</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><p>Building effective malware is a modular process. It isn&#39;t just about writing a malicious script; it is about layering different techniques to bypass modern security stacks. A successful piece of malware must be stored stealthily, remain unreadable to scanners, and execute without triggering behavioral alerts.</p>
<p>Modern development focuses on &quot;Defense Evasion,&quot; ensuring that the payload transitions from a static file to an active process while staying under the radar of EDR and AV solutions.</p>
<hr>
<h3>The Core Pillars of Development</h3>
<p>To build a functional loader or implant, a developer must address several key technical hurdles:</p>
<ul>
<li><strong>The Payload:</strong> Deciding whether the malicious code is self-contained or downloaded in parts to minimize the initial footprint.</li>
<li><strong>Protection:</strong> Using cryptographic methods to ensure the &quot;strings&quot; and &quot;bytes&quot; of the malware aren&#39;t visible until the moment they are needed in memory.</li>
<li><strong>Disguise:</strong> Transforming the structure of the code or data to look like legitimate system traffic or standard application metadata.</li>
<li><strong>The Trigger:</strong> Finding the right &quot;hole&quot; in the OS to inject or call the code, often by abusing trusted Windows APIs or system processes.</li>
</ul>
<hr>
<h3>Components &amp; Architectures</h3>
<p>For a deep dive into the specific implementations of these phases, refer to the following modules:</p>
<ul>
<li><strong><a href="/writeups/Malware%20DEV/Payload%20Placement/Payload%20Placement.html">Payload Placement</a></strong> – Strategizing where the shellcode lives (Staged vs. Stageless).</li>
<li><strong><a href="/writeups/Malware%20DEV/Encryption/Encryption.html">Encryption</a></strong> – Using algorithms like AES, RC4, or XOR to hide the payload.</li>
<li><strong><a href="/writeups/Malware%20DEV/Obfuscation/Obfuscation.html">Obfuscation</a></strong> – Masking the code’s intent through tools and data masquerading.</li>
<li><strong><a href="/writeups/Malware%20DEV/DLL/DLL.html">DLL</a></strong> – Creating Dynamic Link Libraries for side-loading or injection.</li>
<li><strong><a href="/writeups/Malware%20DEV/Execution/Execution.html">Execution</a></strong> – The final transition of shellcode into an active CPU instruction stream.</li>
</ul>
</div>
        <nav class="post-navigation">
          
      <a href="/writeups/Malware DEV/Execution/Remote ShellCode Injection.html" class="nav-link prev-post">
        <span class="nav-direction">← Previous</span>
        <span class="nav-title">Remote Shellcode Injection</span>
      </a>
    
          
      <a href="/writeups/Malware DEV/Obfuscation/Obfuscation Tools.html" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">Obfuscation Tools</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Active Directory/AD Basics.html">Active Directory Fundamentals</a></li><li><a href="/writeups/Active Directory/Lateral Movement and Pivoting.html">Lateral Movement & Pivoting</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>
    (function() {
      function enhanceCodeBlocks(scope) {
        const container = scope || document.querySelector('.writeup-content') || document;
        const blocks = Array.from(container.querySelectorAll('pre > code')).filter(c => !c.closest('.code-block'));
        blocks.forEach(code => {
          const pre = code.parentElement;
          if (!pre || pre.dataset.enhanced === 'true') return;
          pre.dataset.enhanced = 'true';
          let langClass = Array.from(code.classList || []).find(c => c.startsWith('language-'));
          if (!langClass) {
            const t = code.textContent || '';
            if (/#include\s+<[^>]+>/.test(t) || /\bint\s+main\s*\(/.test(t) || /#include\s+<Windows\.h>/i.test(t)) {
              code.classList.add('language-c');
              langClass = 'language-c';
            }
          }
          const lang = (langClass ? langClass.replace('language-', '') : 'text').toUpperCase();
          const wrapper = document.createElement('div');
          wrapper.className = 'code-block';
          const header = document.createElement('div');
          header.className = 'code-header';
          const langEl = document.createElement('span');
          langEl.className = 'code-lang';
          langEl.textContent = lang;
          const btn = document.createElement('button');
          btn.className = 'code-copy';
          btn.type = 'button';
          btn.textContent = 'Copy';
          btn.addEventListener('click', async () => {
            const text = code.innerText;
            const fallbackCopy = () => {
              const ta = document.createElement('textarea');
              ta.value = text;
              ta.style.position = 'fixed';
              ta.style.opacity = '0';
              ta.style.left = '-9999px';
              document.body.appendChild(ta);
              ta.focus();
              ta.select();
              try {
                document.execCommand('copy');
                btn.textContent = 'Copied';
              } catch (_) {
                btn.textContent = 'Failed';
              } finally {
                document.body.removeChild(ta);
                setTimeout(() => (btn.textContent = 'Copy'), 1200);
              }
            };
            try {
              if (navigator.clipboard && window.isSecureContext) {
                await navigator.clipboard.writeText(text);
                btn.textContent = 'Copied';
                setTimeout(() => (btn.textContent = 'Copy'), 1200);
              } else {
                fallbackCopy();
              }
            } catch (_) {
              fallbackCopy();
            }
          });
          header.appendChild(langEl);
          header.appendChild(btn);
          const holder = document.createElement('div');
          holder.className = 'code-content';
          pre.replaceWith(wrapper);
          holder.appendChild(pre);
          wrapper.appendChild(header);
          wrapper.appendChild(holder);
          if (window.hljs && typeof window.hljs.highlightElement === 'function') {
            window.hljs.highlightElement(code);
          } else if (window.hljs && typeof window.hljs.highlightAll === 'function') {
            window.hljs.highlightAll();
          }
        });
      }
      function indentAfterHeadings(scope) {
        const container = scope || document.querySelector('.writeup-content');
        if (!container) return;
        const headings = container.querySelectorAll('h1,h2,h3,h4,h5,h6');
        headings.forEach(h => {
          const level = parseInt(h.tagName.substring(1), 10);
          let el = h.nextElementSibling;
          while (el) {
            if (/^H[1-6]$/.test(el.tagName)) {
              const nextLevel = parseInt(el.tagName.substring(1), 10);
              if (nextLevel <= level) break;
            }
            if (el.tagName === 'P') {
              el.classList.add('indent-p');
            }
            el = el.nextElementSibling;
          }
        });
      }
      function initEnhancements() {
        if (window.mermaid) {
          mermaid.initialize({ startOnLoad: true, theme: 'dark' });
        }
        enhanceCodeBlocks();
        indentAfterHeadings();
        if (window.hljs && typeof window.hljs.highlightAll === 'function') {
          window.hljs.highlightAll();
        }
        const target = document.querySelector('.writeup-content');
        if (target && window.MutationObserver) {
          const mo = new MutationObserver(() => {
            enhanceCodeBlocks(target);
            indentAfterHeadings(target);
            if (window.hljs && typeof window.hljs.highlightAll === 'function') {
              window.hljs.highlightAll();
            }
          });
          mo.observe(target, { childList: true, subtree: true });
        }
      }
      window.addEventListener('load', initEnhancements);
    })();
  </script>
</body>
</html>
